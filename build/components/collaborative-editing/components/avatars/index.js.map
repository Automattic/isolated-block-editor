{"version":3,"file":"index.js","names":["_components","require","_data","_element","_i18n","_compose","createElement","Fragment","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty2","getOwnPropertyDescriptors","defineProperties","defineProperty","CollaborativeEditingAvatars","_ref","peers","onAvatarClick","MAX_AVATAR_COUNT","shouldOverflow","actualAvatarCount","className","VisuallyHidden","slice","map","peer","CollaborativeEditingAvatar","id","CollaborativeEditingAvatarsOverflow","_ref2","_useState","useState","_useState2","_slicedToArray2","isVisible","setIsVisible","name","onMouseEnter","onMouseLeave","onClick","style","borderColor","color","background","Popover","animate","avatarUrl","src","alt","charAt","_ref3","MAX_NAME_COUNT","_useState3","_useState4","NameList","sprintf","__","concat","_default","compose","withSelect","select","getCollabPeers","withDispatch","dispatch","_dispatch","selectBlock","_peer$start","start","clientId","exports"],"sources":["../../../../../src/components/collaborative-editing/components/avatars/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Popover, VisuallyHidden } from '@wordpress/components';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { useState } from '@wordpress/element';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport './style.scss';\n\n/**\n * @param {Object} props\n * @param {import(\"../..\").AvailablePeer[]} props.peers\n * @param {Function} props.onAvatarClick\n */\nexport function CollaborativeEditingAvatars( { peers, onAvatarClick } ) {\n\tconst MAX_AVATAR_COUNT = 4;\n\tconst shouldOverflow = peers.length > MAX_AVATAR_COUNT;\n\tconst actualAvatarCount = shouldOverflow ? MAX_AVATAR_COUNT - 1 : MAX_AVATAR_COUNT;\n\n\treturn (\n\t\t<div className=\"iso-editor-collab-avatars\">\n\t\t\t<VisuallyHidden>Currently editing:</VisuallyHidden>\n\n\t\t\t{ peers.slice( 0, actualAvatarCount ).map( ( peer ) => (\n\t\t\t\t<CollaborativeEditingAvatar key={ peer.id } peer={ peer } onAvatarClick={ onAvatarClick } />\n\t\t\t) ) }\n\n\t\t\t{ shouldOverflow && <CollaborativeEditingAvatarsOverflow peers={ peers?.slice( actualAvatarCount ) } /> }\n\t\t</div>\n\t);\n}\n\nexport function CollaborativeEditingAvatar( { peer, onAvatarClick } ) {\n\tconst [ isVisible, setIsVisible ] = useState( false );\n\n\treturn (\n\t\t<button\n\t\t\tclassName=\"iso-editor-collab-avatars__avatar-btn\"\n\t\t\taria-label={ peer.name }\n\t\t\tonMouseEnter={ () => setIsVisible( true ) }\n\t\t\tonMouseLeave={ () => setIsVisible( false ) }\n\t\t\tonClick={ () => onAvatarClick( peer ) }\n\t\t\tstyle={ {\n\t\t\t\tborderColor: peer.color,\n\t\t\t\tbackground: peer.color,\n\t\t\t} }\n\t\t>\n\t\t\t{ isVisible && (\n\t\t\t\t<Popover className=\"iso-editor-collab-avatars__popover\" animate={ false }>\n\t\t\t\t\t{ peer.name }\n\t\t\t\t</Popover>\n\t\t\t) }\n\t\t\t{ peer.avatarUrl ? (\n\t\t\t\t<img className=\"iso-editor-collab-avatars__image\" src={ peer.avatarUrl } alt=\"\" />\n\t\t\t) : (\n\t\t\t\t<span className=\"iso-editor-collab-avatars__name-initial\">{ peer.name.charAt( 0 ) }</span>\n\t\t\t) }\n\t\t</button>\n\t);\n}\n\nexport function CollaborativeEditingAvatarsOverflow( { peers } ) {\n\tconst MAX_NAME_COUNT = 20;\n\tconst [ isVisible, setIsVisible ] = useState( false );\n\n\tconst NameList = () => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<ul className=\"iso-editor-collab-avatars__overflow-list\">\n\t\t\t\t\t{ peers.slice( 0, MAX_NAME_COUNT ).map( ( peer ) => (\n\t\t\t\t\t\t<li className=\"iso-editor-collab-avatars__overflow-list-item\" key={ peer.id }>\n\t\t\t\t\t\t\t{ peer.name }\n\t\t\t\t\t\t</li>\n\t\t\t\t\t) ) }\n\t\t\t\t</ul>\n\t\t\t\t{ peers.length > MAX_NAME_COUNT && (\n\t\t\t\t\t<p className=\"iso-editor-collab-avatars__overflow-more\">\n\t\t\t\t\t\t{ sprintf(\n\t\t\t\t\t\t\t/* translators: %s: number of how many more users there are */\n\t\t\t\t\t\t\t__( 'and %s more' ),\n\t\t\t\t\t\t\tpeers.length - MAX_NAME_COUNT\n\t\t\t\t\t\t) }\n\t\t\t\t\t</p>\n\t\t\t\t) }\n\t\t\t</>\n\t\t);\n\t};\n\n\treturn (\n\t\t<div className=\"iso-editor-collab-avatars__overflow\">\n\t\t\t{ isVisible && (\n\t\t\t\t<Popover className=\"iso-editor-collab-avatars__popover\" animate={ false }>\n\t\t\t\t\t<NameList />\n\t\t\t\t</Popover>\n\t\t\t) }\n\t\t\t<span\n\t\t\t\taria-hidden=\"true\"\n\t\t\t\tonMouseEnter={ () => setIsVisible( true ) }\n\t\t\t\tonMouseLeave={ () => setIsVisible( false ) }\n\t\t\t>\n\t\t\t\t{ `+${ peers.length }` }\n\t\t\t</span>\n\t\t\t<VisuallyHidden>\n\t\t\t\t<NameList />\n\t\t\t</VisuallyHidden>\n\t\t</div>\n\t);\n}\n\n// @ts-ignore\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst peers = select( 'isolated/editor' ).getCollabPeers();\n\n\t\treturn {\n\t\t\tpeers: Object.keys( peers ).map( ( id ) => {\n\t\t\t\treturn {\n\t\t\t\t\tid,\n\t\t\t\t\t...peers[ id ],\n\t\t\t\t};\n\t\t\t} ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { selectBlock } = dispatch( 'core/block-editor' );\n\n\t\treturn {\n\t\t\tonAvatarClick( peer ) {\n\t\t\t\tif ( peer?.start?.clientId ) {\n\t\t\t\t\tselectBlock( peer.start.clientId );\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t} ),\n] )( CollaborativeEditingAvatars );\n"],"mappings":"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"}