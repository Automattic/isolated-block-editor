{"version":3,"file":"visual-editor.js","names":["_classnames","_interopRequireDefault","require","_blockEditor","_element","_components","_data","_compose","_blocks","_editor","_editorHeadingSlot","_footerSlot","_unlock2","createElement","Fragment","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty2","getOwnPropertyDescriptors","defineProperties","defineProperty","isGutenbergPlugin","_unlock","unlock","blockEditorPrivateApis","LayoutStyle","useLayoutClasses","useLayoutStyles","BlockCanvas","ExperimentalBlockCanvas","getPostContentAttributes","blocks","i","name","attributes","innerBlocks","nestedPostContent","checkForPostContentAtRootLevel","VisualEditor","_ref","styles","_useSelect","useSelect","select","_select","isFeatureActive","_select2","editorStore","getCurrentPostId","getCurrentPostType","getEditorSettings","_select3","blocksStore","getBlockTypes","_isTemplateMode","postTypeSlug","_wrapperBlockName","editorSettings","deviceType","isWelcomeGuideVisible","isTemplateMode","postContentAttributes","editedPostTemplate","undefined","wrapperBlockName","wrapperUniqueId","isBlockBasedTheme","__unstableIsBlockBasedTheme","hasV3BlocksOnly","every","type","apiVersion","_useSelect$editedPost","_useSelect2","isCleanNewPost","hasMetaBoxes","_useSelect3","_settings$__experimen","_settings","blockEditorStore","getSettings","themeHasDisabledLayoutStyles","disableLayoutStyles","themeSupportsLayout","supportsLayout","isFocusMode","focusMode","hasRootPaddingAwareAlignments","__experimentalFeatures","useRootPaddingAwareAlignments","desktopCanvasStyles","height","width","marginLeft","marginRight","display","flexFlow","background","templateModeStyles","borderRadius","border","borderBottom","resizedCanvasStyles","useResizeCanvas","globalLayoutSettings","useSetting","previewMode","toLowerCase","animatedStyles","paddingBottom","ref","useRef","contentRef","useMergeRefs","useTypewriter","fallbackLayout","useMemo","newestPostContentAttributes","content","parseableContent","parse","hasPostContentAtRootLevel","_ref2","_ref2$layout","layout","_ref2$align","align","postContentLayoutClasses","blockListLayoutClass","classnames","concat","postContentLayoutStyles","postContentLayout","inherit","contentSize","wideSize","blockListLayout","postEditorLayout","titleRef","useEffect","_titleRef$current","current","focus","_toConsumableArray2","css","alignCSS","isToBeIframed","BlockTools","__unstableContentRef","className","__unstableMotion","div","animate","padding","initial","shouldIframe","selector","Slot","mode","__experimentalRecursionProvider","blockName","uniqueId","BlockList"],"sources":["../../../src/components/block-editor/visual-editor.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tBlockList,\n\tBlockTools,\n\tstore as blockEditorStore,\n\t__unstableUseTypewriter as useTypewriter,\n\t__experimentalUseResizeCanvas as useResizeCanvas,\n\tuseSetting,\n\t__experimentalRecursionProvider as RecursionProvider,\n\tprivateApis as blockEditorPrivateApis,\n// @ts-ignore\n} from '@wordpress/block-editor';\nimport { useEffect, useRef, useMemo } from '@wordpress/element';\nimport { __unstableMotion as motion } from '@wordpress/components';\nimport { useSelect } from '@wordpress/data';\nimport { useMergeRefs } from '@wordpress/compose';\n// @ts-ignore\nimport { parse, store as blocksStore } from '@wordpress/blocks';\n// @ts-ignore\nimport { store as editorStore } from '@wordpress/editor';\n\n// @ts-ignore\nconst isGutenbergPlugin = true;\n\n/**\n * Internal dependencies\n */\nimport EditorHeading from '../editor-heading-slot';\nimport FooterSlot from '../footer-slot';\nimport { unlock } from './unlock';\n\n\nconst {\n\tLayoutStyle,\n\tuseLayoutClasses,\n\tuseLayoutStyles,\n\tExperimentalBlockCanvas: BlockCanvas,\n} = unlock( blockEditorPrivateApis );\n\n/**\n * Given an array of nested blocks, find the first Post Content\n * block inside it, recursing through any nesting levels,\n * and return its attributes.\n *\n * @param {Array} blocks A list of blocks.\n *\n * @return {Object | undefined} The Post Content block.\n */\nfunction getPostContentAttributes( blocks ) {\n\tfor ( let i = 0; i < blocks.length; i++ ) {\n\t\tif ( blocks[ i ].name === 'core/post-content' ) {\n\t\t\treturn blocks[ i ].attributes;\n\t\t}\n\t\tif ( blocks[ i ].innerBlocks.length ) {\n\t\t\tconst nestedPostContent = getPostContentAttributes(\n\t\t\t\tblocks[ i ].innerBlocks\n\t\t\t);\n\n\t\t\tif ( nestedPostContent ) {\n\t\t\t\treturn nestedPostContent;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction checkForPostContentAtRootLevel( blocks ) {\n\tfor ( let i = 0; i < blocks.length; i++ ) {\n\t\tif ( blocks[ i ].name === 'core/post-content' ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\n/**\n * This is a copy of packages/edit-post/src/components/visual-editor/index.js\n *\n * The original is not exported, and contains code for post titles\n *\n * @param {Object} args\n * @param args.styles\n */\nexport default function VisualEditor( { styles } ) {\n\tconst {\n\t\tdeviceType,\n\t\tisWelcomeGuideVisible,\n\t\tisTemplateMode,\n\t\tpostContentAttributes,\n\t\teditedPostTemplate = {},\n\t\twrapperBlockName,\n\t\twrapperUniqueId,\n\t\t// @ts-ignore\n\t\tisBlockBasedTheme,\n\t\t// @ts-ignore\n\t\thasV3BlocksOnly,\n\t} = useSelect( ( select ) => {\n\t\tconst {\n\t\t\tisFeatureActive,\n\t\t} = select( 'isolated/editor' );\n\t\tconst { getCurrentPostId, getCurrentPostType, getEditorSettings } =\n\t\t\tselect( editorStore );\n\t\tconst { getBlockTypes } = select( blocksStore );\n\t\tconst _isTemplateMode = false;\n\t\tconst postTypeSlug = getCurrentPostType();\n\t\tlet _wrapperBlockName;\n\n\t\tif ( postTypeSlug === 'wp_block' ) {\n\t\t\t_wrapperBlockName = 'core/block';\n\t\t} else if ( ! _isTemplateMode ) {\n\t\t\t_wrapperBlockName = 'core/post-content';\n\t\t}\n\n\t\tconst editorSettings = getEditorSettings();\n\n\t\treturn {\n\t\t\tdeviceType: 'Desktop',\n\t\t\t// @ts-ignore\n\t\t\tisWelcomeGuideVisible: isFeatureActive( 'welcomeGuide' ),\n\t\t\tisTemplateMode: _isTemplateMode,\n\t\t\tpostContentAttributes: getEditorSettings().postContentAttributes,\n\t\t\t// Post template fetch returns a 404 on classic themes, which\n\t\t\t// messes with e2e tests, so check it's a block theme first.\n\t\t\teditedPostTemplate: undefined,\n\t\t\twrapperBlockName: _wrapperBlockName,\n\t\t\twrapperUniqueId: getCurrentPostId(),\n\t\t\tisBlockBasedTheme: editorSettings.__unstableIsBlockBasedTheme,\n\t\t\thasV3BlocksOnly: getBlockTypes().every( ( type ) => {\n\t\t\t\treturn type.apiVersion >= 3;\n\t\t\t} ),\n\t\t};\n\t}, [] );\n\t// @ts-ignore\n\tconst { isCleanNewPost } = useSelect( editorStore );\n\tconst hasMetaBoxes = false;\n\tconst {\n\t\tthemeHasDisabledLayoutStyles,\n\t\tthemeSupportsLayout,\n\t} = useSelect( ( select ) => {\n\t\tconst _settings = select( blockEditorStore ).getSettings();\n\t\treturn {\n\t\t\tthemeHasDisabledLayoutStyles: _settings.disableLayoutStyles,\n\t\t\tthemeSupportsLayout: _settings.supportsLayout,\n\t\t\tisFocusMode: _settings.focusMode,\n\t\t\thasRootPaddingAwareAlignments:\n\t\t\t\t_settings.__experimentalFeatures?.useRootPaddingAwareAlignments,\n\t\t};\n\t}, [] );\n\tconst desktopCanvasStyles = {\n\t\theight: '100%',\n\t\twidth: '100%',\n\t\tmarginLeft: 'auto',\n\t\tmarginRight: 'auto',\n\t\tdisplay: 'flex',\n\t\tflexFlow: 'column',\n\t\t// Default background color so that grey\n\t\t// .edit-post-editor-regions__content color doesn't show through.\n\t\tbackground: 'white',\n\t};\n\tconst templateModeStyles = {\n\t\t...desktopCanvasStyles,\n\t\tborderRadius: '2px 2px 0 0',\n\t\tborder: '1px solid #ddd',\n\t\tborderBottom: 0,\n\t};\n\tconst resizedCanvasStyles = useResizeCanvas( deviceType, isTemplateMode );\n\tconst globalLayoutSettings = useSetting( 'layout' );\n\tconst previewMode = 'is-' + deviceType.toLowerCase() + '-preview';\n\n\tlet animatedStyles = isTemplateMode\n\t\t? templateModeStyles\n\t\t: desktopCanvasStyles;\n\tif ( resizedCanvasStyles ) {\n\t\tanimatedStyles = resizedCanvasStyles;\n\t}\n\n\tlet paddingBottom;\n\n\t// Add a constant padding for the typewritter effect. When typing at the\n\t// bottom, there needs to be room to scroll up.\n\tif ( ! hasMetaBoxes && ! resizedCanvasStyles && ! isTemplateMode ) {\n\t\tpaddingBottom = '40vh';\n\t}\n\n\tconst ref = useRef();\n\tconst contentRef = useMergeRefs( [ ref, useTypewriter() ] );\n\n\t// fallbackLayout is used if there is no Post Content,\n\t// and for Post Title.\n\tconst fallbackLayout = useMemo( () => {\n\t\tif ( isTemplateMode ) {\n\t\t\treturn { type: 'default' };\n\t\t}\n\n\t\tif ( themeSupportsLayout ) {\n\t\t\t// We need to ensure support for wide and full alignments,\n\t\t\t// so we add the constrained type.\n\t\t\treturn { ...globalLayoutSettings, type: 'constrained' };\n\t\t}\n\t\t// Set default layout for classic themes so all alignments are supported.\n\t\treturn { type: 'default' };\n\t}, [ isTemplateMode, themeSupportsLayout, globalLayoutSettings ] );\n\n\tconst newestPostContentAttributes = useMemo( () => {\n\t\t// @ts-ignore\n\t\tif ( ! editedPostTemplate?.content && ! editedPostTemplate?.blocks ) {\n\t\t\treturn postContentAttributes;\n\t\t}\n\t\t// When in template editing mode, we can access the blocks directly.\n\t\t// @ts-ignore\n\t\tif ( editedPostTemplate?.blocks ) {\n\t\t\t// @ts-ignore\n\t\t\treturn getPostContentAttributes( editedPostTemplate?.blocks );\n\t\t}\n\t\t// If there are no blocks, we have to parse the content string.\n\t\t// Best double-check it's a string otherwise the parse function gets unhappy.\n\t\t// @ts-ignore\n\t\tconst parseableContent =\n\t\t\t// @ts-ignore\n\t\t\ttypeof editedPostTemplate?.content === 'string'\n\t\t\t\t// @ts-ignore\n\t\t\t\t? editedPostTemplate?.content\n\t\t\t\t: '';\n\n\t\t// @ts-ignore\n\t\treturn getPostContentAttributes( parse( parseableContent ) ) || {};\n\t}, [\n\t\t// @ts-ignore\n\t\teditedPostTemplate?.content,\n\t\t// @ts-ignore\n\t\teditedPostTemplate?.blocks,\n\t\tpostContentAttributes,\n\t] );\n\n\tconst hasPostContentAtRootLevel = useMemo( () => {\n\t\t// @ts-ignore\n\t\tif ( ! editedPostTemplate?.content && ! editedPostTemplate?.blocks ) {\n\t\t\treturn false;\n\t\t}\n\t\t// When in template editing mode, we can access the blocks directly.\n\t\t// @ts-ignore\n\t\tif ( editedPostTemplate?.blocks ) {\n\t\t\t// @ts-ignore\n\t\t\treturn checkForPostContentAtRootLevel( editedPostTemplate?.blocks );\n\t\t}\n\t\t// If there are no blocks, we have to parse the content string.\n\t\t// Best double-check it's a string otherwise the parse function gets unhappy.\n\t\tconst parseableContent =\n\t\t\t// @ts-ignore\n\t\t\ttypeof editedPostTemplate?.content === 'string'\n\t\t\t\t// @ts-ignore\n\t\t\t\t? editedPostTemplate?.content\n\t\t\t\t: '';\n\n\t\treturn (\n\t\t\tcheckForPostContentAtRootLevel( parse( parseableContent ) ) || false\n\t\t);\n\t// @ts-ignore\n\t}, [ editedPostTemplate?.content, editedPostTemplate?.blocks ] );\n\n\tconst { layout = {}, align = '' } = newestPostContentAttributes || {};\n\n\tconst postContentLayoutClasses = useLayoutClasses(\n\t\tnewestPostContentAttributes,\n\t\t'core/post-content'\n\t);\n\n\tconst blockListLayoutClass = classnames(\n\t\t{\n\t\t\t'is-layout-flow': ! themeSupportsLayout,\n\t\t},\n\t\tthemeSupportsLayout && postContentLayoutClasses,\n\t\talign && `align${ align }`\n\t);\n\n\tconst postContentLayoutStyles = useLayoutStyles(\n\t\tnewestPostContentAttributes,\n\t\t'core/post-content',\n\t\t'.block-editor-block-list__layout.is-root-container'\n\t);\n\n\t// Update type for blocks using legacy layouts.\n\tconst postContentLayout = useMemo( () => {\n\t\treturn layout &&\n\t\t\t( layout?.type === 'constrained' ||\n\t\t\t\tlayout?.inherit ||\n\t\t\t\tlayout?.contentSize ||\n\t\t\t\tlayout?.wideSize )\n\t\t\t? { ...globalLayoutSettings, ...layout, type: 'constrained' }\n\t\t\t: { ...globalLayoutSettings, ...layout, type: 'default' };\n\t}, [\n\t\tlayout?.type,\n\t\tlayout?.inherit,\n\t\tlayout?.contentSize,\n\t\tlayout?.wideSize,\n\t\tglobalLayoutSettings,\n\t] );\n\n\t// If there is a Post Content block we use its layout for the block list;\n\t// if not, this must be a classic theme, in which case we use the fallback layout.\n\tconst blockListLayout = postContentAttributes\n\t\t? postContentLayout\n\t\t: fallbackLayout;\n\n\tconst postEditorLayout =\n\t\tblockListLayout?.type === 'default' && ! hasPostContentAtRootLevel\n\t\t\t? fallbackLayout\n\t\t\t: blockListLayout;\n\n\tconst titleRef = useRef();\n\tuseEffect( () => {\n\t\tif ( isWelcomeGuideVisible || ! isCleanNewPost() ) {\n\t\t\treturn;\n\t\t}\n\t\t// @ts-ignore\n\t\ttitleRef?.current?.focus();\n\t}, [ isWelcomeGuideVisible, isCleanNewPost ] );\n\n\tstyles = useMemo(\n\t\t() => [\n\t\t\t...styles,\n\t\t\t{\n\t\t\t\t// We should move this in to future to the body.\n\t\t\t\tcss:\n\t\t\t\t\t`.edit-post-visual-editor__post-title-wrapper{margin-top:4rem}` +\n\t\t\t\t\t( paddingBottom\n\t\t\t\t\t\t? `body{padding-bottom:${ paddingBottom }}`\n\t\t\t\t\t\t: '' ),\n\t\t\t},\n\t\t],\n\t\t[ styles ]\n\t);\n\n\t// Add some styles for alignwide/alignfull Post Content and its children.\n\tconst alignCSS = `.is-root-container.alignwide { max-width: var(--wp--style--global--wide-size); margin-left: auto; margin-right: auto;}\n\t\t.is-root-container.alignwide:where(.is-layout-flow) > :not(.alignleft):not(.alignright) { max-width: var(--wp--style--global--wide-size);}\n\t\t.is-root-container.alignfull { max-width: none; margin-left: auto; margin-right: auto;}\n\t\t.is-root-container.alignfull:where(.is-layout-flow) > :not(.alignleft):not(.alignright) { max-width: none;}`;\n\n\t// TODO: Styles not appearing in the iframe mode yet\n\t// const isToBeIframed =\n\t// \t( ( hasV3BlocksOnly || ( isGutenbergPlugin && isBlockBasedTheme ) ) &&\n\t// \t\t! hasMetaBoxes ) ||\n\t// \tisTemplateMode ||\n\t// \tdeviceType === 'Tablet' ||\n\t// \tdeviceType === 'Mobile';\n\tconst isToBeIframed = false;\n\n\treturn (\n\t\t<BlockTools\n\t\t\t__unstableContentRef={ ref }\n\t\t\tclassName={ classnames( 'edit-post-visual-editor', {\n\t\t\t\t'is-template-mode': isTemplateMode,\n\t\t\t\t'has-inline-canvas': ! isToBeIframed,\n\t\t\t} ) }\n\t\t>\n\t\t\t<motion.div\n\t\t\t\tclassName=\"edit-post-visual-editor__content-area\"\n\t\t\t\tanimate={ {\n\t\t\t\t\tpadding: isTemplateMode ? '48px 48px 0' : 0,\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t<motion.div\n\t\t\t\t\tanimate={ animatedStyles }\n\t\t\t\t\tinitial={ desktopCanvasStyles }\n\t\t\t\t\tclassName={ previewMode }\n\t\t\t\t>\n\t\t\t\t\t<BlockCanvas\n\t\t\t\t\t\tshouldIframe={ isToBeIframed }\n\t\t\t\t\t\tcontentRef={ contentRef }\n\t\t\t\t\t\tstyles={ styles }\n\t\t\t\t\t\theight=\"100%\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{ themeSupportsLayout &&\n\t\t\t\t\t\t\t! themeHasDisabledLayoutStyles &&\n\t\t\t\t\t\t\t! isTemplateMode && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<LayoutStyle\n\t\t\t\t\t\t\t\t\t\tselector=\".edit-post-visual-editor__post-title-wrapper\"\n\t\t\t\t\t\t\t\t\t\tlayout={ fallbackLayout }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<LayoutStyle\n\t\t\t\t\t\t\t\t\t\tselector=\".block-editor-block-list__layout.is-root-container\"\n\t\t\t\t\t\t\t\t\t\tlayout={ postEditorLayout }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{ align && (\n\t\t\t\t\t\t\t\t\t\t<LayoutStyle css={ alignCSS } />\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t{ postContentLayoutStyles && (\n\t\t\t\t\t\t\t\t\t\t<LayoutStyle\n\t\t\t\t\t\t\t\t\t\t\tlayout={ postContentLayout }\n\t\t\t\t\t\t\t\t\t\t\tcss={ postContentLayoutStyles }\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t) }\n\n\t\t\t\t\t\t<EditorHeading.Slot mode=\"visual\" />\n\n\t\t\t\t\t\t<RecursionProvider\n\t\t\t\t\t\t\tblockName={ wrapperBlockName }\n\t\t\t\t\t\t\tuniqueId={ wrapperUniqueId }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BlockList\n\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\tisTemplateMode\n\t\t\t\t\t\t\t\t\t\t? 'wp-site-blocks'\n\t\t\t\t\t\t\t\t\t\t: `${ blockListLayoutClass } wp-block-post-content` // Ensure root level blocks receive default/flow blockGap styling rules.\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlayout={ blockListLayout }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</RecursionProvider>\n\n\t\t\t\t\t\t<FooterSlot.Slot mode=\"visual\" />\n\t\t\t\t\t</BlockCanvas>\n\t\t\t\t</motion.div>\n\t\t\t</motion.div>\n\t\t</BlockTools>\n\t);\n}\n"],"mappings":"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"}