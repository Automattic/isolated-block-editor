{"version":3,"sources":["../../../src/components/block-editor/visual-editor.js"],"names":["MaybeIframe","children","contentRef","shouldIframe","styles","style","ref","flex","width","height","display","VisualEditor","themeSupportsLayout","select","blockEditorStore","getSettings","supportsLayout","deviceType","getPreviewDeviceType","resizedCanvasStyles","defaultLayout","previewMode","toLowerCase","desktopCanvasStyles","margin","flexFlow","background","animatedStyles","blockSelectionClearerRef","layout","undefined","padding"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport React from 'react';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tBlockList,\n\tWritingFlow,\n\tstore as blockEditorStore,\n\tuseSetting,\n\t__unstableEditorStyles as EditorStyles,\n\t__experimentalLayoutStyle as LayoutStyle,\n\t__unstableUseBlockSelectionClearer as useBlockSelectionClearer,\n\t__unstableUseTypewriter as useTypewriter,\n\t__unstableUseClipboardHandler as useClipboardHandler,\n\t__unstableUseTypingObserver as useTypingObserver,\n\t__experimentalBlockSettingsMenuFirstItem,\n\t__experimentalUseResizeCanvas as useResizeCanvas,\n\t__unstableUseMouseMoveTypingReset as useMouseMoveTypingReset,\n\t__unstableIframe as Iframe,\n\tBlockTools,\n} from '@wordpress/block-editor';\nimport { useSelect } from '@wordpress/data';\nimport { __unstableMotion as motion } from '@wordpress/components';\nimport { useRef, useMemo } from '@wordpress/element';\nimport { useMergeRefs } from '@wordpress/compose';\n\nfunction MaybeIframe( { children, contentRef, shouldIframe, styles, style } ) {\n\tconst ref = useMouseMoveTypingReset();\n\n\tif ( ! shouldIframe ) {\n\t\t// TODO: this will add an EditorStyles for each editor on the page, which includes adding a <style> element. probably harmless but something to keep an eye on\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<EditorStyles styles={ styles } />\n\t\t\t\t<WritingFlow\n\t\t\t\t\tref={ contentRef }\n\t\t\t\t\tclassName=\"editor-styles-wrapper\"\n\t\t\t\t\tstyle={ { flex: '1', ...style } }\n\t\t\t\t\ttabIndex={ -1 }\n\t\t\t\t>\n\t\t\t\t\t{ children }\n\t\t\t\t</WritingFlow>\n\t\t\t</>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Iframe\n\t\t\thead={ <EditorStyles styles={ styles } /> }\n\t\t\tref={ ref }\n\t\t\tcontentRef={ contentRef }\n\t\t\tstyle={ { width: '100%', height: '100%', display: 'block' } }\n\t\t\tname=\"editor-canvas\"\n\t\t>\n\t\t\t{ children }\n\t\t</Iframe>\n\t);\n}\n\n/**\n * This is a copy of packages/edit-post/src/components/visual-editor/index.js\n *\n * The original is not exported, and contains code for post titles\n */\nconst VisualEditor = ( { styles } ) => {\n\tconst themeSupportsLayout = useSelect( ( select ) => {\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\treturn getSettings().supportsLayout;\n\t}, [] );\n\tconst { deviceType } = useSelect( ( select ) => {\n\t\treturn {\n\t\t\tdeviceType: select( 'isolated/editor' ).getPreviewDeviceType(),\n\t\t};\n\t} );\n\tconst resizedCanvasStyles = useResizeCanvas( deviceType, false );\n\tconst defaultLayout = useSetting( 'layout' );\n\tconst previewMode = 'is-' + deviceType.toLowerCase() + '-preview';\n\n\tconst desktopCanvasStyles = {\n\t\t// We intentionally omit a 100% height here. The container is a flex item, so the 100% height is granted by default.\n\t\t// If a percentage height is present, older browsers such as Safari 13 apply that, but do so incorrectly as the inheritance is buggy.\n\t\twidth: '100%',\n\t\tmargin: 0,\n\t\tdisplay: 'flex',\n\t\tflexFlow: 'column',\n\t\t// Default background color so that grey\n\t\t// .edit-post-editor-regions__content color doesn't show through.\n\t\tbackground: 'white',\n\t};\n\tlet animatedStyles = desktopCanvasStyles;\n\tif ( resizedCanvasStyles ) {\n\t\tanimatedStyles = resizedCanvasStyles;\n\t}\n\n\tconst blockSelectionClearerRef = useBlockSelectionClearer();\n\tconst ref = useRef();\n\tconst contentRef = useMergeRefs( [\n\t\tref,\n\t\tuseClipboardHandler(),\n\t\tuseTypewriter(),\n\t\tuseBlockSelectionClearer(),\n\t\tuseTypingObserver(),\n\t] );\n\n\tconst layout = useMemo( () => {\n\t\tif ( themeSupportsLayout ) {\n\t\t\treturn defaultLayout;\n\t\t}\n\n\t\treturn undefined;\n\t}, [ themeSupportsLayout, defaultLayout ] );\n\n\treturn (\n\t\t<BlockTools __unstableContentRef={ ref } className=\"edit-post-visual-editor\">\n\t\t\t<motion.div\n\t\t\t\tclassName=\"edit-post-visual-editor__content-area\"\n\t\t\t\tanimate={ {\n\t\t\t\t\tpadding: '0',\n\t\t\t\t} }\n\t\t\t\tref={ blockSelectionClearerRef }\n\t\t\t>\n\t\t\t\t<motion.div animate={ animatedStyles } initial={ desktopCanvasStyles } className={ previewMode }>\n\t\t\t\t\t<MaybeIframe\n\t\t\t\t\t\tshouldIframe={ deviceType === 'Tablet' || deviceType === 'Mobile' }\n\t\t\t\t\t\tcontentRef={ contentRef }\n\t\t\t\t\t\tstyles={ styles }\n\t\t\t\t\t\tstyle={ {} }\n\t\t\t\t\t>\n\t\t\t\t\t\t<LayoutStyle\n\t\t\t\t\t\t\tselector=\".edit-post-visual-editor__post-title-wrapper, .block-editor-block-list__layout.is-root-container\"\n\t\t\t\t\t\t\tlayout={ defaultLayout }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<BlockList className={ undefined } __experimentalLayout={ layout } />\n\t\t\t\t\t</MaybeIframe>\n\t\t\t\t</motion.div>\n\t\t\t</motion.div>\n\t\t</BlockTools>\n\t);\n};\n\nexport default VisualEditor;\n"],"file":"visual-editor.js"}