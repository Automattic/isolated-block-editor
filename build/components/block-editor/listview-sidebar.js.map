{"version":3,"file":"listview-sidebar.js","names":["_classnames","_interopRequireDefault","require","_blockEditor","_components","_compose","_data","_dom","_element","_i18n","_icons","_keyboardShortcuts","_keycodes","_listViewOutline","createElement","ListViewSidebar","_ref","_ref$canClose","canClose","_useDispatch","useDispatch","setIsListViewOpened","focusOnMountRef","useFocusOnMount","headerFocusReturnRef","useFocusReturn","contentFocusReturnRef","closeOnEscape","event","keyCode","ESCAPE","defaultPrevented","preventDefault","_useState","useState","_useState2","_slicedToArray2","tab","setTab","sidebarRef","useRef","listViewTabRef","outlineTabRef","listViewRef","handleSidebarFocus","currentTab","listViewApplicationFocus","focus","tabbable","find","current","listViewFocusArea","contains","useShortcut","ownerDocument","activeElement","__","className","onKeyDown","ref","Button","icon","closeSmall","label","onClick","classnames","useMergeRefs","__experimentalListView"],"sources":["../../../src/components/block-editor/listview-sidebar.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { __experimentalListView as ListView } from '@wordpress/block-editor';\nimport { Button } from '@wordpress/components';\nimport {\n\tuseFocusOnMount,\n\tuseFocusReturn,\n\tuseMergeRefs,\n} from '@wordpress/compose';\nimport { useDispatch } from '@wordpress/data';\nimport { focus } from '@wordpress/dom';\nimport { useRef, useState } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { closeSmall } from '@wordpress/icons';\nimport { useShortcut } from '@wordpress/keyboard-shortcuts';\nimport { ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport ListViewOutline from './list-view-outline';\n\nexport default function ListViewSidebar( { canClose = true } ) {\n\tconst { setIsListViewOpened } = useDispatch( 'isolated/editor' );\n\n\tconst focusOnMountRef = useFocusOnMount( 'firstElement' );\n\tconst headerFocusReturnRef = useFocusReturn();\n\tconst contentFocusReturnRef = useFocusReturn();\n\n\tfunction closeOnEscape( event ) {\n\t\tif ( event.keyCode === ESCAPE && !event.defaultPrevented ) {\n\t\t\tevent.preventDefault();\n\t\t\tsetIsListViewOpened( false );\n\t\t}\n\t}\n\n\tconst [ tab, setTab ] = useState( 'list-view' );\n\n\t// This ref refers to the sidebar as a whole.\n\tconst sidebarRef = useRef();\n\t// This ref refers to the list view tab button.\n\tconst listViewTabRef = useRef();\n\t// This ref refers to the outline tab button.\n\tconst outlineTabRef = useRef();\n\t// This ref refers to the list view application area.\n\tconst listViewRef = useRef();\n\n\t/*\n\t * Callback function to handle list view or outline focus.\n\t *\n\t * @param {string} currentTab The current tab. Either list view or outline.\n\t *\n\t * @return void\n\t */\n\tfunction handleSidebarFocus( currentTab ) {\n\t\t// List view tab is selected.\n\t\tif ( currentTab === 'list-view' ) {\n\t\t\t// Either focus the list view or the list view tab button. Must have a fallback because the list view does not render when there are no blocks.\n\t\t\t// @ts-ignore\n\t\t\tconst listViewApplicationFocus = focus.tabbable.find( listViewRef.current )[ 0 ];\n\t\t\t// @ts-ignore\n\t\t\tconst listViewFocusArea = sidebarRef.current.contains(\n\t\t\t\tlistViewApplicationFocus\n\t\t\t)\n\t\t\t\t? listViewApplicationFocus\n\t\t\t\t: listViewTabRef.current;\n\t\t\t// @ts-ignore\n\t\t\tlistViewFocusArea.focus();\n\t\t\t// Outline tab is selected.\n\t\t} else {\n\t\t\t// @ts-ignore\n\t\t\toutlineTabRef.current.focus();\n\t\t}\n\t}\n\n\t// This only fires when the sidebar is open because of the conditional rendering. It is the same shortcut to open but that is defined as a global shortcut and only fires when the sidebar is closed.\n\tuseShortcut( 'core/edit-post/toggle-list-view', () => {\n\t\t// If the sidebar has focus, it is safe to close.\n\t\t// @ts-ignore\n\t\tif ( sidebarRef.current.contains( sidebarRef.current.ownerDocument.activeElement ) ) {\n\t\t\tsetIsListViewOpened( false );\n\t\t\t// If the list view or outline does not have focus, focus should be moved to it.\n\t\t} else {\n\t\t\thandleSidebarFocus( tab );\n\t\t}\n\t} );\n\n\treturn (\n\t\t// eslint-disable-next-line jsx-a11y/no-static-element-interactions\n\t\t<div\n\t\t\taria-label={ __( 'Document Overview' ) }\n\t\t\tclassName=\"edit-post-editor__document-overview-panel\"\n\t\t\tonKeyDown={ closeOnEscape }\n\t\t\t// @ts-ignore\n\t\t\tref={ sidebarRef }\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName=\"edit-post-editor__document-overview-panel-header components-panel__header edit-post-sidebar__panel-tabs\"\n\t\t\t\tref={ headerFocusReturnRef }\n\t\t\t>\n\t\t\t\t{ canClose && <Button\n\t\t\t\t\ticon={ closeSmall }\n\t\t\t\t\tlabel={ __( 'Close Document Overview Sidebar' ) }\n\t\t\t\t\tonClick={ () => setIsListViewOpened( false ) }\n\t\t\t\t/> }\n\t\t\t\t<ul>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tref={ listViewTabRef }\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tsetTab( 'list-view' );\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t\t'edit-post-sidebar__panel-tab',\n\t\t\t\t\t\t\t\t{ 'is-active': tab === 'list-view' }\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\taria-current={ tab === 'list-view' }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'List View' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tref={ outlineTabRef }\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tsetTab( 'outline' );\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t\t'edit-post-sidebar__panel-tab',\n\t\t\t\t\t\t\t\t{ 'is-active': tab === 'outline' }\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\taria-current={ tab === 'outline' }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Outline' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tref={ useMergeRefs( [\n\t\t\t\t\tcontentFocusReturnRef,\n\t\t\t\t\tfocusOnMountRef,\n\t\t\t\t\tlistViewRef,\n\t\t\t\t] ) }\n\t\t\t\tclassName=\"edit-post-editor__list-view-container\"\n\t\t\t>\n\t\t\t\t{ tab === 'list-view' && (\n\t\t\t\t\t<div className=\"edit-post-editor__list-view-panel-content\">\n\t\t\t\t\t\t<ListView />\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t\t{ tab === 'outline' && <ListViewOutline /> }\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"],"mappings":"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"}