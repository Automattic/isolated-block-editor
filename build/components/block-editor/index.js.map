{"version":3,"file":"index.js","names":["interfaceLabels","secondarySidebar","__","header","body","sidebar","actions","footer","BlockEditor","props","isEditing","editorMode","children","undo","redo","settings","renderMoreMenu","styles","isMobileViewport","useViewportMatch","inspectorInSidebar","iso","inspector","inserterInSidebar","inserter","showHeader","showFooter","useSelect","select","isFeatureActive","isInserterOpened","isListViewOpened","isOptionActive","sidebarIsOpened","interfaceStore","getActiveComplementaryArea","hasFixedToolbar","isFullscreenActive","showIconLabels","previousShortcut","keyboardShortcutsStore","getAllShortcutKeyCombinations","nextShortcut","className","classnames","useEffect","html","document","querySelector","classList","add","remove","toolbar","documentInspector","rawShortcut","primary","primaryShift","previous","next","withDispatch","dispatch"],"sources":["../../../src/components/block-editor/index.js"],"sourcesContent":["// @ts-nocheck\n/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { withDispatch, useSelect } from '@wordpress/data';\nimport { KeyboardShortcuts } from '@wordpress/components';\nimport { rawShortcut } from '@wordpress/keycodes';\nimport { useViewportMatch } from '@wordpress/compose';\nimport { BlockEditorKeyboardShortcuts } from '@wordpress/block-editor';\nimport { EditorNotices, EditorSnackbars } from '@wordpress/editor';\nimport { FullscreenMode, ComplementaryArea, InterfaceSkeleton, store as interfaceStore } from '@wordpress/interface';\nimport { __ } from '@wordpress/i18n';\nimport { store as keyboardShortcutsStore } from '@wordpress/keyboard-shortcuts';\nimport { useEffect } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport SettingsSidebar from './sidebar';\nimport VisualEditor from './visual-editor';\nimport TextEditor from './text-editor';\nimport './style.scss';\nimport BlockEditorToolbar from '../block-editor-toolbar';\nimport InserterSidebar from './inserter-sidebar';\nimport ListViewSidebar from './listview-sidebar';\nimport Footer from './footer';\nimport ActionArea from '../action-area';\n\n/** @typedef {import('../../store/editor/reducer').EditorMode} EditorMode */\n/** @typedef {import('../../index').BlockEditorSettings} BlockEditorSettings */\n/** @typedef {import('../../index').OnMore} OnMore */\n\n/**\n * Undo/redo\n *\n * @callback OnHistory\n */\n\nconst interfaceLabels = {\n\tsecondarySidebar: __( 'Block library' ),\n\t/* translators: accessibility text for the editor top bar landmark region. */\n\theader: __( 'Editor top bar' ),\n\t/* translators: accessibility text for the editor content landmark region. */\n\tbody: __( 'Editor content' ),\n\t/* translators: accessibility text for the editor settings landmark region. */\n\tsidebar: __( 'Editor settings' ),\n\t/* translators: accessibility text for the editor publish landmark region. */\n\tactions: __( 'Editor publish' ),\n\t/* translators: accessibility text for the editor footer landmark region. */\n\tfooter: __( 'Editor footer' ),\n};\n\n/**\n * The editor component. Contains the visual or text editor, along with keyboard handling.\n *\n * Note: the keyboard handling is specific to this editor and *not* global\n *\n * @param {Object} props - Component props\n * @param {boolean} props.isEditing - Are we editing in this editor?\n * @param {EditorMode} props.editorMode - Visual or code?\n * @param {BlockEditorSettings} props.settings - Settings\n * @param {Object} props.children - Child components\n * @param {OnHistory} props.undo\n * @param {OnHistory} props.redo\n * @param {OnMore} props.renderMoreMenu - Callback to render additional items in the more menu\n */\nfunction BlockEditor( props ) {\n\tconst { isEditing, editorMode, children, undo, redo, settings, renderMoreMenu } = props;\n\tconst styles = {}; // TODO: do we need hasThemeStyles support here?\n\tconst isMobileViewport = useViewportMatch( 'medium', '<' );\n\tconst inspectorInSidebar = settings?.iso?.sidebar?.inspector || false;\n\tconst inserterInSidebar = settings?.iso?.sidebar?.inserter || false;\n\tconst showHeader = settings?.iso?.header ?? true;\n\tconst showFooter = settings?.iso?.footer || false;\n\tconst {\n\t\tsidebarIsOpened,\n\t\thasFixedToolbar,\n\t\tisInserterOpened,\n\t\tisListViewOpened,\n\t\tshowIconLabels,\n\t\tisFullscreenActive,\n\t\tpreviousShortcut,\n\t\tnextShortcut,\n\t} = useSelect( ( select ) => {\n\t\tconst { isFeatureActive, isInserterOpened, isListViewOpened, isOptionActive } = select( 'isolated/editor' );\n\n\t\treturn {\n\t\t\tsidebarIsOpened: !!select( interfaceStore ).getActiveComplementaryArea( 'isolated/editor' ),\n\t\t\thasFixedToolbar: isFeatureActive( 'fixedToolbar' ),\n\t\t\tisInserterOpened: isInserterOpened(),\n\t\t\tisListViewOpened: isListViewOpened(),\n\t\t\tisFullscreenActive: isOptionActive( 'fullscreenMode' ),\n\t\t\tshowIconLabels: isFeatureActive( 'showIconLabels' ),\n\t\t\tpreviousShortcut: select( keyboardShortcutsStore ).getAllShortcutKeyCombinations(\n\t\t\t\t'core/edit-post/previous-region'\n\t\t\t),\n\t\t\tnextShortcut: select( keyboardShortcutsStore ).getAllShortcutKeyCombinations(\n\t\t\t\t'core/edit-post/next-region'\n\t\t\t),\n\t\t};\n\t}, [] );\n\tconst className = classnames( 'edit-post-layout', 'is-mode-' + editorMode, {\n\t\t'is-sidebar-opened': sidebarIsOpened,\n\t\t'has-fixed-toolbar': hasFixedToolbar,\n\t\t'show-icon-labels': showIconLabels,\n\t} );\n\tconst secondarySidebar = () => {\n\t\tif ( !inserterInSidebar ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( editorMode === 'visual' && isInserterOpened ) {\n\t\t\treturn <InserterSidebar />;\n\t\t}\n\n\t\tif ( editorMode === 'visual' && isListViewOpened ) {\n\t\t\treturn <ListViewSidebar />;\n\t\t}\n\n\t\treturn null;\n\t};\n\n\t// For back-compat with older iso-editor\n\tuseEffect( () => {\n\t\tconst html = document.querySelector( 'html' );\n\n\t\tif ( isFullscreenActive ) {\n\t\t\t// @ts-ignore\n\t\t\thtml.classList.add( 'is-fullscreen-mode' );\n\t\t} else {\n\t\t\t// @ts-ignore\n\t\t\thtml.classList.remove( 'is-fullscreen-mode' );\n\t\t}\n\n\t\treturn () => {\n\t\t\tif ( html ) {\n\t\t\t\thtml.classList.remove( 'is-fullscreen-mode' );\n\t\t\t}\n\t\t};\n\t}, [ isFullscreenActive ] );\n\n\tconst header = showHeader ? (\n\t\t<BlockEditorToolbar editorMode={ editorMode } settings={ settings } renderMoreMenu={ renderMoreMenu } />\n\t) : null;\n\n\treturn (\n\t\t<>\n\t\t\t<SettingsSidebar documentInspector={ settings?.iso?.toolbar?.documentInspector ?? false } />\n\t\t\t<FullscreenMode isActive={ isFullscreenActive } />\n\n\t\t\t<InterfaceSkeleton\n\t\t\t\tclassName={ className }\n\t\t\t\tlabels={ interfaceLabels }\n\t\t\t\theader={ header }\n\t\t\t\tsecondarySidebar={ secondarySidebar() }\n\t\t\t\tsidebar={\n\t\t\t\t\t( !isMobileViewport || sidebarIsOpened ) &&\n\t\t\t\t\tinspectorInSidebar && <ComplementaryArea.Slot scope=\"isolated/editor\" />\n\t\t\t\t}\n\t\t\t\tnotices={ <EditorSnackbars /> }\n\t\t\t\tcontent={\n\t\t\t\t\t<>\n\t\t\t\t\t\t<EditorNotices />\n\n\t\t\t\t\t\t{ isEditing && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<BlockEditorKeyboardShortcuts />\n\t\t\t\t\t\t\t\t<BlockEditorKeyboardShortcuts.Register />\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) }\n\n\t\t\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\t\t\tbindGlobal={ false }\n\t\t\t\t\t\t\tshortcuts={ {\n\t\t\t\t\t\t\t\t[ rawShortcut.primary( 'z' ) ]: undo,\n\t\t\t\t\t\t\t\t[ rawShortcut.primaryShift( 'z' ) ]: redo,\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ editorMode === 'visual' && <VisualEditor styles={ styles } /> }\n\t\t\t\t\t\t\t{ editorMode === 'text' && <TextEditor /> }\n\t\t\t\t\t\t</KeyboardShortcuts>\n\n\t\t\t\t\t\t{ children }\n\t\t\t\t\t</>\n\t\t\t\t}\n\t\t\t\tfooter={ showFooter && <Footer editorMode={ editorMode } /> }\n\t\t\t\tactions={ <ActionArea.Slot /> }\n\t\t\t\tshortcuts={ {\n\t\t\t\t\tprevious: previousShortcut,\n\t\t\t\t\tnext: nextShortcut,\n\t\t\t\t} }\n\t\t\t/>\n\t\t</>\n\t);\n}\n\nexport default withDispatch( ( dispatch ) => {\n\tconst { redo, undo } = dispatch( 'isolated/editor' );\n\treturn { redo, undo };\n} )( BlockEditor );\n"],"mappings":"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"}