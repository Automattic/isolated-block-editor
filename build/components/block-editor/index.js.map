{"version":3,"sources":["../../../src/components/block-editor/index.js"],"names":["interfaceLabels","secondarySidebar","header","body","sidebar","actions","footer","BlockEditor","props","isEditing","editorMode","children","undo","redo","settings","renderMoreMenu","isMobileViewport","inspectorInSidebar","iso","inspector","inserterInSidebar","inserter","showFooter","select","isFeatureActive","isInserterOpened","isListViewOpened","isOptionActive","sidebarIsOpened","interfaceStore","getActiveComplementaryArea","hasFixedToolbar","isFullscreenActive","showIconLabels","previousShortcut","keyboardShortcutsStore","getAllShortcutKeyCombinations","nextShortcut","className","rawShortcut","primary","primaryShift","previous","next","dispatch","_ownProps","hasPeers","maybeUndo","actionCreator","noticeId","removeNotice","createNotice","id"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { withDispatch } from '@wordpress/data';\nimport { KeyboardShortcuts } from '@wordpress/components';\nimport { rawShortcut } from '@wordpress/keycodes';\nimport { useViewportMatch } from '@wordpress/compose';\nimport { BlockEditorKeyboardShortcuts } from '@wordpress/block-editor';\nimport { EditorNotices, EditorSnackbars } from '@wordpress/editor';\nimport { FullscreenMode, ComplementaryArea, InterfaceSkeleton, store as interfaceStore } from '@wordpress/interface';\nimport { __, _x } from '@wordpress/i18n';\nimport { useSelect } from '@wordpress/data';\nimport { store as keyboardShortcutsStore } from '@wordpress/keyboard-shortcuts';\n\n/**\n * Internal dependencies\n */\nimport SettingsSidebar from './sidebar';\nimport VisualEditor from './visual-editor';\nimport TextEditor from './text-editor';\nimport './style.scss';\nimport BlockEditorToolbar from '../block-editor-toolbar';\nimport InserterSidebar from './inserter-sidebar';\nimport ListViewSidebar from './listview-sidebar';\nimport Footer from './footer';\n\n/** @typedef {import('../../store/editor/reducer').EditorMode} EditorMode */\n/** @typedef {import('../../index').BlockEditorSettings} BlockEditorSettings */\n/** @typedef {import('../../index').OnMore} OnMore */\n\n/**\n * Undo/redo\n * @callback OnHistory\n */\n\nconst interfaceLabels = {\n\tsecondarySidebar: __( 'Block library' ),\n\t/* translators: accessibility text for the editor top bar landmark region. */\n\theader: __( 'Editor top bar' ),\n\t/* translators: accessibility text for the editor content landmark region. */\n\tbody: __( 'Editor content' ),\n\t/* translators: accessibility text for the editor settings landmark region. */\n\tsidebar: __( 'Editor settings' ),\n\t/* translators: accessibility text for the editor publish landmark region. */\n\tactions: __( 'Editor publish' ),\n\t/* translators: accessibility text for the editor footer landmark region. */\n\tfooter: __( 'Editor footer' ),\n};\n\n/**\n * The editor component. Contains the visual or text editor, along with keyboard handling.\n *\n * Note: the keyboard handling is specific to this editor and *not* global\n *\n * @param {object} props - Component props\n * @param {boolean} props.isEditing - Are we editing in this editor?\n * @param {EditorMode} props.editorMode - Visual or code?\n * @param {BlockEditorSettings} props.settings - Settings\n * @param {object} props.children - Child components\n * @param {OnHistory} props.undo\n * @param {OnHistory} props.redo\n * @param {OnMore} props.renderMoreMenu - Callback to render additional items in the more menu\n */\nfunction BlockEditor( props ) {\n\tconst { isEditing, editorMode, children, undo, redo, settings, renderMoreMenu } = props;\n\tconst isMobileViewport = useViewportMatch( 'medium', '<' );\n\tconst inspectorInSidebar = settings?.iso?.sidebar?.inspector || false;\n\tconst inserterInSidebar = settings?.iso?.sidebar?.inserter || false;\n\tconst showFooter = settings?.iso?.footer || false;\n\tconst {\n\t\tsidebarIsOpened,\n\t\thasFixedToolbar,\n\t\tisInserterOpened,\n\t\tisListViewOpened,\n\t\tshowIconLabels,\n\t\tisFullscreenActive,\n\t\tpreviousShortcut,\n\t\tnextShortcut,\n\t} = useSelect( ( select ) => {\n\t\tconst { isFeatureActive, isInserterOpened, isListViewOpened, isOptionActive } = select( 'isolated/editor' );\n\n\t\treturn {\n\t\t\tsidebarIsOpened: !! select( interfaceStore ).getActiveComplementaryArea( 'isolated/editor' ),\n\t\t\thasFixedToolbar: isFeatureActive( 'fixedToolbar' ),\n\t\t\tisInserterOpened: isInserterOpened(),\n\t\t\tisListViewOpened: isListViewOpened(),\n\t\t\tisFullscreenActive: isOptionActive( 'fullscreenMode' ),\n\t\t\tshowIconLabels: isFeatureActive( 'showIconLabels' ),\n\t\t\tpreviousShortcut: select( keyboardShortcutsStore ).getAllShortcutKeyCombinations(\n\t\t\t\t'core/edit-post/previous-region'\n\t\t\t),\n\t\t\tnextShortcut: select( keyboardShortcutsStore ).getAllShortcutKeyCombinations(\n\t\t\t\t'core/edit-post/next-region'\n\t\t\t),\n\t\t};\n\t}, [] );\n\tconst className = classnames( 'edit-post-layout', 'is-mode-' + editorMode, {\n\t\t'is-sidebar-opened': sidebarIsOpened,\n\t\t'has-fixed-toolbar': hasFixedToolbar,\n\t\t'show-icon-labels': showIconLabels,\n\t} );\n\tconst secondarySidebar = () => {\n\t\tif ( ! inserterInSidebar ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( editorMode === 'visual' && isInserterOpened ) {\n\t\t\treturn <InserterSidebar />;\n\t\t}\n\n\t\tif ( editorMode === 'visual' && isListViewOpened ) {\n\t\t\treturn <ListViewSidebar />;\n\t\t}\n\n\t\treturn null;\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<SettingsSidebar />\n\t\t\t<FullscreenMode isActive={ isFullscreenActive } />\n\n\t\t\t<InterfaceSkeleton\n\t\t\t\tclassName={ className }\n\t\t\t\tlabels={ interfaceLabels }\n\t\t\t\theader={\n\t\t\t\t\t<BlockEditorToolbar\n\t\t\t\t\t\teditorMode={ editorMode }\n\t\t\t\t\t\tsettings={ settings }\n\t\t\t\t\t\trenderMoreMenu={ renderMoreMenu }\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t\tsecondarySidebar={ secondarySidebar() }\n\t\t\t\tsidebar={\n\t\t\t\t\t( ! isMobileViewport || sidebarIsOpened ) &&\n\t\t\t\t\tinspectorInSidebar && <ComplementaryArea.Slot scope=\"isolated/editor\" />\n\t\t\t\t}\n\t\t\t\tnotices={ <EditorSnackbars /> }\n\t\t\t\tcontent={\n\t\t\t\t\t<>\n\t\t\t\t\t\t<EditorNotices />\n\n\t\t\t\t\t\t{ isEditing && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<BlockEditorKeyboardShortcuts />\n\t\t\t\t\t\t\t\t<BlockEditorKeyboardShortcuts.Register />\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) }\n\n\t\t\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\t\t\tbindGlobal={ false }\n\t\t\t\t\t\t\tshortcuts={ {\n\t\t\t\t\t\t\t\t[ rawShortcut.primary( 'z' ) ]: undo,\n\t\t\t\t\t\t\t\t[ rawShortcut.primaryShift( 'z' ) ]: redo,\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ editorMode === 'visual' && <VisualEditor /> }\n\t\t\t\t\t\t\t{ editorMode === 'text' && <TextEditor /> }\n\t\t\t\t\t\t</KeyboardShortcuts>\n\n\t\t\t\t\t\t{ children }\n\t\t\t\t\t</>\n\t\t\t\t}\n\t\t\t\tfooter={ showFooter && <Footer editorMode={ editorMode } /> }\n\t\t\t\tactions={ null }\n\t\t\t\tshortcuts={ {\n\t\t\t\t\tprevious: previousShortcut,\n\t\t\t\t\tnext: nextShortcut,\n\t\t\t\t} }\n\t\t\t/>\n\t\t</>\n\t);\n}\n\nexport default withDispatch( ( dispatch, _ownProps, { select } ) => {\n\tconst hasPeers = select( 'isolated/editor' ).hasPeers;\n\tconst { redo, undo } = dispatch( 'isolated/editor' );\n\n\tconst maybeUndo = ( actionCreator ) => () => {\n\t\tif ( hasPeers() ) {\n\t\t\tconst noticeId = 'isolated/undo-disabled';\n\t\t\tdispatch( 'core/notices' ).removeNotice( noticeId );\n\t\t\treturn dispatch( 'core/notices' ).createNotice(\n\t\t\t\t'warning',\n\t\t\t\t'Undo/redo is disabled while editing with other users.',\n\t\t\t\t{ id: noticeId }\n\t\t\t);\n\t\t} else {\n\t\t\treturn actionCreator();\n\t\t}\n\t};\n\n\treturn {\n\t\tredo: maybeUndo( redo ),\n\t\tundo: maybeUndo( undo ),\n\t};\n} )( BlockEditor );\n"],"file":"index.js"}