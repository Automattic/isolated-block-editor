{"version":3,"file":"post-text-editor.js","names":["_reactAutosizeTextarea","_interopRequireDefault","require","_i18n","_element","_data","_compose","_blocks","createElement","Fragment","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf2","result","NewTarget","constructor","Reflect","construct","arguments","apply","_possibleConstructorReturn2","sham","Proxy","Boolean","prototype","valueOf","call","e","PostTextEditor","_Component","_inherits2","_super","props","_this","_classCallCheck2","edit","bind","_assertThisInitialized2","stopEditing","state","_createClass2","key","value","event","target","onChange","setState","isDirty","onPersist","render","instanceId","htmlFor","concat","className","__","autoComplete","dir","onBlur","id","placeholder","getDerivedStateFromProps","Component","exports","_default","compose","withSelect","select","_select","getBlocks","serialize","withDispatch","dispatch","_dispatch","updateBlocksWithoutUndo","content","blocks","parse","withInstanceId"],"sources":["../../../src/components/block-editor/post-text-editor.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport Textarea from 'react-autosize-textarea';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport { parse, serialize } from '@wordpress/blocks';\n\nexport class PostTextEditor extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.edit = this.edit.bind( this );\n\t\tthis.stopEditing = this.stopEditing.bind( this );\n\n\t\tthis.state = {};\n\t}\n\n\tstatic getDerivedStateFromProps( props, state ) {\n\t\tif ( state.isDirty ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tvalue: props.value,\n\t\t\tisDirty: false,\n\t\t};\n\t}\n\n\t/**\n\t * Handles a textarea change event to notify the onChange prop callback and\n\t * reflect the new value in the component's own state. This marks the start\n\t * of the user's edits, if not already changed, preventing future props\n\t * changes to value from replacing the rendered value. This is expected to\n\t * be followed by a reset to dirty state via `stopEditing`.\n\t *\n\t * @see stopEditing\n\t *\n\t * @param {Event} event Change event.\n\t */\n\tedit( event ) {\n\t\t// @ts-ignore */}\n\t\tconst value = event.target.value;\n\t\tthis.props.onChange( value );\n\t\tthis.setState( { value, isDirty: true } );\n\t}\n\n\t/**\n\t * Function called when the user has completed their edits, responsible for\n\t * ensuring that changes, if made, are surfaced to the onPersist prop\n\t * callback and resetting dirty state.\n\t */\n\tstopEditing() {\n\t\tif ( this.state.isDirty ) {\n\t\t\tthis.props.onPersist( this.state.value );\n\t\t\tthis.setState( { isDirty: false } );\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { value } = this.state;\n\t\tconst { instanceId } = this.props;\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<label htmlFor={ `post-content-${ instanceId }` } className=\"screen-reader-text\">\n\t\t\t\t\t{ __( 'Type text or HTML' ) }\n\t\t\t\t</label>\n\t\t\t\t<Textarea\n\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\tdir=\"auto\"\n\t\t\t\t\tvalue={ value }\n\t\t\t\t\t// @ts-ignore */}\n\t\t\t\t\tonChange={ this.edit }\n\t\t\t\t\tonBlur={ this.stopEditing }\n\t\t\t\t\tclassName=\"editor-post-text-editor\"\n\t\t\t\t\tid={ `post-content-${ instanceId }` }\n\t\t\t\t\tplaceholder={ __( 'Start writing with text or HTML' ) }\n\t\t\t\t/>\n\t\t\t</>\n\t\t);\n\t}\n}\n\n// @ts-ignore\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { getBlocks } = select( 'isolated/editor' );\n\t\treturn {\n\t\t\tvalue: serialize( getBlocks() ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { updateBlocksWithoutUndo } = dispatch( 'isolated/editor' );\n\t\treturn {\n\t\t\tonChange( content ) {\n\t\t\t\tconst blocks = parse( content );\n\t\t\t\tupdateBlocksWithoutUndo( blocks );\n\t\t\t},\n\t\t\tonPersist( content ) {\n\t\t\t\tconst blocks = parse( content );\n\t\t\t\tupdateBlocksWithoutUndo( blocks );\n\t\t\t},\n\t\t};\n\t} ),\n\twithInstanceId,\n] )( PostTextEditor );\n"],"mappings":"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"}