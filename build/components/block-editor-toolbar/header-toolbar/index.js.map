{"version":3,"file":"index.js","names":["preventDefault","event","HeaderToolbar","props","inserterButton","useRef","useDispatch","setIsInserterOpened","setIsListViewOpened","isMobileViewport","useViewportMatch","useSelect","select","hasInserterItems","getBlockRootClientId","getBlockSelectionEnd","isListViewOpened","keyboardShortcutsStore","getShortcutRepresentation","hasFixedToolbar","isFeatureActive","isInserterEnabled","getEditorMode","getEditorSettings","richEditingEnabled","isListViewOpen","isTextModeEnabled","previewDeviceType","isInserterOpened","showIconLabels","listViewShortcut","isLargeViewport","isWideViewport","settings","iso","toolbar","inserter","toc","navigation","undo","selectorTool","inserterInSidebar","sidebar","displayBlockToolbar","toolbarAriaLabel","__","openInserter","useCallback","toggleListView","Button","plus","_x","current","EditorHistoryUndo","undefined","EditorHistoryRedo","BlockNavigationDropdown","listView","TableOfContents"],"sources":["../../../../src/components/block-editor-toolbar/header-toolbar/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useViewportMatch } from '@wordpress/compose';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { __, _x } from '@wordpress/i18n';\nimport { ToolbarItem, Button, Popover } from '@wordpress/components';\nimport { NavigableToolbar, __experimentalLibrary as Library, ToolSelector } from '@wordpress/block-editor';\nimport { TableOfContents } from '@wordpress/editor';\nimport { plus, listView } from '@wordpress/icons';\nimport { useRef, useCallback } from '@wordpress/element';\nimport { store as keyboardShortcutsStore } from '@wordpress/keyboard-shortcuts';\n\n/**\n * Internal dependencies\n */\nimport EditorHistoryRedo from './redo';\nimport EditorHistoryUndo from './undo';\nimport BlockNavigationDropdown from '../block-navigation';\n\nconst preventDefault = ( event ) => {\n\tevent.preventDefault();\n};\n\nfunction HeaderToolbar( props ) {\n\tconst inserterButton = useRef();\n\tconst { setIsInserterOpened, setIsListViewOpened } = useDispatch( 'isolated/editor' );\n\tconst isMobileViewport = useViewportMatch( 'medium', '<' );\n\tconst {\n\t\thasFixedToolbar,\n\t\tisInserterEnabled,\n\t\tisTextModeEnabled,\n\t\tshowIconLabels,\n\t\tpreviewDeviceType,\n\t\tisInserterOpened,\n\t\tisListViewOpen,\n\t\tlistViewShortcut,\n\t} = useSelect( ( select ) => {\n\t\tconst { hasInserterItems, getBlockRootClientId, getBlockSelectionEnd } = select( 'core/block-editor' );\n\t\tconst { isListViewOpened } = select( 'isolated/editor' );\n\t\t// @ts-ignore\n\t\tconst { getShortcutRepresentation } = select( keyboardShortcutsStore );\n\n\t\treturn {\n\t\t\t// @ts-ignore\n\t\t\thasFixedToolbar: select( 'isolated/editor' ).isFeatureActive( 'fixedToolbar' ),\n\t\t\t// This setting (richEditingEnabled) should not live in the block editor's setting.\n\t\t\tisInserterEnabled:\n\t\t\t\t// @ts-ignore\n\t\t\t\tselect( 'isolated/editor' ).getEditorMode() === 'visual' &&\n\t\t\t\t// @ts-ignore\n\t\t\t\tselect( 'core/editor' ).getEditorSettings().richEditingEnabled &&\n\t\t\t\t// @ts-ignore\n\t\t\t\thasInserterItems( getBlockRootClientId( getBlockSelectionEnd() ) ),\n\t\t\t// @ts-ignore\n\t\t\tisListViewOpen: isListViewOpened(),\n\t\t\t// @ts-ignore\n\t\t\tisTextModeEnabled: select( 'isolated/editor' ).getEditorMode() === 'text',\n\t\t\tpreviewDeviceType: 'Desktop',\n\t\t\t// @ts-ignore\n\t\t\tisInserterOpened: select( 'isolated/editor' ).isInserterOpened(),\n\t\t\tshowIconLabels: false, // Not implemented yet\n\t\t\tlistViewShortcut: getShortcutRepresentation( 'core/edit-post/toggle-list-view' ),\n\t\t};\n\t}, [] );\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst isWideViewport = useViewportMatch( 'wide' );\n\tconst { inserter, toc, navigation, undo, selectorTool } = props.settings.iso.toolbar;\n\tconst inserterInSidebar = props.settings?.iso?.sidebar?.inserter || false;\n\tconst displayBlockToolbar = ! isLargeViewport || previewDeviceType !== 'Desktop' || hasFixedToolbar;\n\tconst toolbarAriaLabel = displayBlockToolbar\n\t\t? /* translators: accessibility text for the editor toolbar when Top Toolbar is on */\n\t\t  __( 'Document and block tools' )\n\t\t: /* translators: accessibility text for the editor toolbar when Top Toolbar is off */\n\t\t  __( 'Document tools' );\n\tconst openInserter = useCallback( () => {\n\t\tif ( isInserterOpened ) {\n\t\t\t// Focusing the inserter button closes the inserter popover\n\t\t\t// @ts-ignore\n\t\t\tsetIsInserterOpened( false );\n\t\t} else {\n\t\t\tsetIsInserterOpened( true );\n\t\t}\n\t}, [ isInserterOpened, setIsInserterOpened ] );\n\n\tconst toggleListView = useCallback( () => setIsListViewOpened( ! isListViewOpen ), [\n\t\tsetIsListViewOpened,\n\t\tisListViewOpen,\n\t] );\n\n\treturn (\n\t\t<NavigableToolbar className=\"edit-post-header-toolbar\" aria-label={ toolbarAriaLabel }>\n\t\t\t{ ( inserter || undo || navigation || toc || selectorTool ) && (\n\t\t\t\t<div className=\"edit-post-header-toolbar__left\">\n\t\t\t\t\t{ inserter && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tref={ inserterButton }\n\t\t\t\t\t\t\tas={ Button }\n\t\t\t\t\t\t\tclassName=\"edit-post-header-toolbar__inserter-toggle\"\n\t\t\t\t\t\t\tisPressed={ isInserterOpened }\n\t\t\t\t\t\t\tonMouseDown={ preventDefault }\n\t\t\t\t\t\t\tonClick={ openInserter }\n\t\t\t\t\t\t\tdisabled={ ! isInserterEnabled }\n\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\ticon={ plus }\n\t\t\t\t\t\t\t/* translators: button label text should, if possible, be under 16\n\t\t\t\t\tcharacters. */\n\t\t\t\t\t\t\tlabel={ _x( 'Toggle block inserter', 'Generic label for block inserter button' ) }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ isInserterOpened && ! inserterInSidebar && (\n\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\tposition=\"bottom right\"\n\t\t\t\t\t\t\tonClose={ () => setIsInserterOpened( false ) }\n\t\t\t\t\t\t\tanchor={ inserterButton.current }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Library\n\t\t\t\t\t\t\t\tshowMostUsedBlocks={ false }\n\t\t\t\t\t\t\t\tshowInserterHelpPanel\n\t\t\t\t\t\t\t\tonSelect={ () => {\n\t\t\t\t\t\t\t\t\tif ( isMobileViewport ) {\n\t\t\t\t\t\t\t\t\t\tsetIsInserterOpened( false );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Popover>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ selectorTool && <ToolSelector /> }\n\t\t\t\t\t{ undo && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ EditorHistoryUndo }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ undo && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ EditorHistoryRedo }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ navigation && ! inserterInSidebar && (\n\t\t\t\t\t\t<ToolbarItem as={ BlockNavigationDropdown } isDisabled={ isTextModeEnabled } />\n\t\t\t\t\t) }\n\t\t\t\t\t{ navigation && inserterInSidebar && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ Button }\n\t\t\t\t\t\t\tclassName=\"edit-post-header-toolbar__list-view-toggle\"\n\t\t\t\t\t\t\ticon={ listView }\n\t\t\t\t\t\t\tdisabled={ isTextModeEnabled }\n\t\t\t\t\t\t\tisPressed={ isListViewOpen }\n\t\t\t\t\t\t\t/* translators: button label text should, if possible, be under 16 characters. */\n\t\t\t\t\t\t\tlabel={ __( 'List View' ) }\n\t\t\t\t\t\t\tonClick={ toggleListView }\n\t\t\t\t\t\t\tshortcut={ listViewShortcut }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ toc && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ TableOfContents }\n\t\t\t\t\t\t\thasOutlineItemsDisabled={ isTextModeEnabled }\n\t\t\t\t\t\t\trepositionDropdown={ showIconLabels && ! isWideViewport }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t) }\n\t\t</NavigableToolbar>\n\t);\n}\n\nexport default HeaderToolbar;\n"],"mappings":"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"}