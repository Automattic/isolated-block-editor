{"version":3,"file":"index.js","names":["preventDefault","event","HeaderToolbar","props","inserterButton","useRef","useDispatch","setIsInserterOpened","setIsListViewOpened","isMobileViewport","useViewportMatch","useSelect","select","hasInserterItems","getBlockRootClientId","getBlockSelectionEnd","isListViewOpened","keyboardShortcutsStore","getShortcutRepresentation","hasFixedToolbar","isFeatureActive","isInserterEnabled","getEditorMode","getEditorSettings","richEditingEnabled","isListViewOpen","isTextModeEnabled","previewDeviceType","isInserterOpened","showIconLabels","listViewShortcut","isLargeViewport","isWideViewport","settings","iso","toolbar","inserter","toc","navigation","undo","selectorTool","inserterInSidebar","sidebar","displayBlockToolbar","toolbarAriaLabel","__","openInserter","useCallback","toggleListView","Button","plus","_x","current","EditorHistoryUndo","undefined","EditorHistoryRedo","BlockNavigationDropdown","listView","TableOfContents"],"sources":["../../../../src/components/block-editor-toolbar/header-toolbar/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useViewportMatch } from '@wordpress/compose';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { __, _x } from '@wordpress/i18n';\nimport { ToolbarItem, Button, Popover } from '@wordpress/components';\nimport { NavigableToolbar, __experimentalLibrary as Library, ToolSelector } from '@wordpress/block-editor';\nimport { TableOfContents } from '@wordpress/editor';\nimport { plus, listView } from '@wordpress/icons';\nimport { useRef, useCallback } from '@wordpress/element';\nimport { store as keyboardShortcutsStore } from '@wordpress/keyboard-shortcuts';\n\n/**\n * Internal dependencies\n */\nimport EditorHistoryRedo from './redo';\nimport EditorHistoryUndo from './undo';\nimport BlockNavigationDropdown from '../block-navigation';\n\nconst preventDefault = ( event ) => {\n\tevent.preventDefault();\n};\n\nfunction HeaderToolbar( props ) {\n\tconst inserterButton = useRef();\n\tconst { setIsInserterOpened, setIsListViewOpened } = useDispatch( 'isolated/editor' );\n\tconst isMobileViewport = useViewportMatch( 'medium', '<' );\n\tconst {\n\t\thasFixedToolbar,\n\t\tisInserterEnabled,\n\t\tisTextModeEnabled,\n\t\tshowIconLabels,\n\t\tpreviewDeviceType,\n\t\tisInserterOpened,\n\t\tisListViewOpen,\n\t\tlistViewShortcut,\n\t} = useSelect( ( select ) => {\n\t\tconst { hasInserterItems, getBlockRootClientId, getBlockSelectionEnd } = select( 'core/block-editor' );\n\t\tconst { isListViewOpened } = select( 'isolated/editor' );\n\t\t// @ts-ignore\n\t\tconst { getShortcutRepresentation } = select( keyboardShortcutsStore );\n\n\t\treturn {\n\t\t\t// @ts-ignore\n\t\t\thasFixedToolbar: select( 'isolated/editor' ).isFeatureActive( 'fixedToolbar' ),\n\t\t\t// This setting (richEditingEnabled) should not live in the block editor's setting.\n\t\t\tisInserterEnabled:\n\t\t\t\t// @ts-ignore\n\t\t\t\tselect( 'isolated/editor' ).getEditorMode() === 'visual' &&\n\t\t\t\t// @ts-ignore\n\t\t\t\tselect( 'core/editor' ).getEditorSettings().richEditingEnabled &&\n\t\t\t\t// @ts-ignore\n\t\t\t\thasInserterItems( getBlockRootClientId( getBlockSelectionEnd() ) ),\n\t\t\t// @ts-ignore\n\t\t\tisListViewOpen: isListViewOpened(),\n\t\t\t// @ts-ignore\n\t\t\tisTextModeEnabled: select( 'isolated/editor' ).getEditorMode() === 'text',\n\t\t\tpreviewDeviceType: 'Desktop',\n\t\t\t// @ts-ignore\n\t\t\tisInserterOpened: select( 'isolated/editor' ).isInserterOpened(),\n\t\t\tshowIconLabels: false, // Not implemented yet\n\t\t\tlistViewShortcut: getShortcutRepresentation( 'core/edit-post/toggle-list-view' ),\n\t\t};\n\t}, [] );\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst isWideViewport = useViewportMatch( 'wide' );\n\tconst { inserter, toc, navigation, undo, selectorTool } = props.settings.iso.toolbar;\n\tconst inserterInSidebar = props.settings?.iso?.sidebar?.inserter || false;\n\tconst displayBlockToolbar = ! isLargeViewport || previewDeviceType !== 'Desktop' || hasFixedToolbar;\n\tconst toolbarAriaLabel = displayBlockToolbar\n\t\t? /* translators: accessibility text for the editor toolbar when Top Toolbar is on */\n\t\t  __( 'Document and block tools' )\n\t\t: /* translators: accessibility text for the editor toolbar when Top Toolbar is off */\n\t\t  __( 'Document tools' );\n\tconst openInserter = useCallback( () => {\n\t\tif ( isInserterOpened ) {\n\t\t\t// Focusing the inserter button closes the inserter popover\n\t\t\t// @ts-ignore\n\t\t\tsetIsInserterOpened( false );\n\t\t} else {\n\t\t\tsetIsInserterOpened( true );\n\t\t}\n\t}, [ isInserterOpened, setIsInserterOpened ] );\n\n\tconst toggleListView = useCallback( () => setIsListViewOpened( ! isListViewOpen ), [\n\t\tsetIsListViewOpened,\n\t\tisListViewOpen,\n\t] );\n\n\treturn (\n\t\t<NavigableToolbar className=\"edit-post-header-toolbar\" aria-label={ toolbarAriaLabel }>\n\t\t\t{ ( inserter || undo || navigation || toc || selectorTool ) && (\n\t\t\t\t<div className=\"edit-post-header-toolbar__left\">\n\t\t\t\t\t{ inserter && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tref={ inserterButton }\n\t\t\t\t\t\t\tas={ Button }\n\t\t\t\t\t\t\tclassName=\"edit-post-header-toolbar__inserter-toggle\"\n\t\t\t\t\t\t\tisPressed={ isInserterOpened }\n\t\t\t\t\t\t\tonMouseDown={ preventDefault }\n\t\t\t\t\t\t\tonClick={ openInserter }\n\t\t\t\t\t\t\tdisabled={ ! isInserterEnabled }\n\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\ticon={ plus }\n\t\t\t\t\t\t\t/* translators: button label text should, if possible, be under 16\n\t\t\t\t\tcharacters. */\n\t\t\t\t\t\t\tlabel={ _x( 'Toggle block inserter', 'Generic label for block inserter button' ) }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ isInserterOpened && ! inserterInSidebar && (\n\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\tposition=\"bottom right\"\n\t\t\t\t\t\t\tonClose={ () => setIsInserterOpened( false ) }\n\t\t\t\t\t\t\tanchor={ inserterButton.current }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Library\n\t\t\t\t\t\t\t\tshowMostUsedBlocks={ false }\n\t\t\t\t\t\t\t\tshowInserterHelpPanel\n\t\t\t\t\t\t\t\tonSelect={ () => {\n\t\t\t\t\t\t\t\t\tif ( isMobileViewport ) {\n\t\t\t\t\t\t\t\t\t\tsetIsInserterOpened( false );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Popover>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ selectorTool && <ToolSelector /> }\n\t\t\t\t\t{ undo && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ EditorHistoryUndo }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ undo && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ EditorHistoryRedo }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ navigation && ! inserterInSidebar && (\n\t\t\t\t\t\t<ToolbarItem as={ BlockNavigationDropdown } isDisabled={ isTextModeEnabled } />\n\t\t\t\t\t) }\n\t\t\t\t\t{ navigation && inserterInSidebar && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ Button }\n\t\t\t\t\t\t\tclassName=\"edit-post-header-toolbar__list-view-toggle\"\n\t\t\t\t\t\t\ticon={ listView }\n\t\t\t\t\t\t\tdisabled={ isTextModeEnabled }\n\t\t\t\t\t\t\tisPressed={ isListViewOpen }\n\t\t\t\t\t\t\t/* translators: button label text should, if possible, be under 16 characters. */\n\t\t\t\t\t\t\tlabel={ __( 'List View' ) }\n\t\t\t\t\t\t\tonClick={ toggleListView }\n\t\t\t\t\t\t\tshortcut={ listViewShortcut }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ toc && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ TableOfContents }\n\t\t\t\t\t\t\thasOutlineItemsDisabled={ isTextModeEnabled }\n\t\t\t\t\t\t\trepositionDropdown={ showIconLabels && ! isWideViewport }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t) }\n\t\t</NavigableToolbar>\n\t);\n}\n\nexport default HeaderToolbar;\n"],"mappings":"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"}