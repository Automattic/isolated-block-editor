{"version":3,"file":"index.js","names":["_blockEditor","require","_element","_components","_icons","_i18n","_data","_compose","_classnames","_interopRequireDefault","_moreMenu","_headerToolbar","_inspector","_slot","createElement","Fragment","BlockEditorToolbar","props","_settings$iso","_settings$iso2","ref","useRef","settings","editorMode","renderMoreMenu","isHugeViewport","useViewportMatch","blockToolbarRef","isLargeViewport","_ref","iso","toolbar","inspector","_ref2","moreMenu","inspectorInSidebar","sidebar","_useDispatch","useDispatch","openGeneralSidebar","closeGeneralSidebar","_useDispatch2","setIsInserterOpened","_useSelect","useSelect","select","isEditing","isEditorSidebarOpened","isBlockSelected","getBlockSelectionStart","hasBlockSelected","isInserterOpened","_useState","useState","_useState2","_slicedToArray2","isBlockToolsCollapsed","setIsBlockToolsCollapsed","useEffect","toggleSidebar","isOpen","className","role","tabIndex","classnames","BlockToolbar","hideDragHandle","Popover","Slot","name","Button","icon","next","previous","onClick","collapsed","label","__","cog","isPressed","disabled","button","onToggle","_default","exports"],"sources":["../../../src/components/block-editor-toolbar/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\n\nimport {\tBlockToolbar } from '@wordpress/block-editor';\nimport { useEffect, useRef, useState } from '@wordpress/element';\nimport { Button, Popover } from '@wordpress/components';\nimport { cog, next, previous } from '@wordpress/icons';\nimport { __ } from '@wordpress/i18n';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { useViewportMatch } from '@wordpress/compose';\n\n/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * Internal dependencies\n */\nimport MoreMenu from './more-menu';\nimport HeaderToolbar from './header-toolbar';\nimport Inspector from './inspector';\nimport ToolbarSlot from './slot';\nimport './style.scss';\n\n/** @typedef {import('../../store/editor/reducer').EditorMode} EditorMode */\n/** @typedef {import('../../index').BlockEditorSettings} BlockEditorSettings */\n/** @typedef {import('../../index').OnMore} OnMore */\n\n/**\n * Block editor toolbar\n *\n * @param {Object} props - Component props\n * @param {BlockEditorSettings} props.settings - Settings\n * @param {EditorMode} props.editorMode - Visual or code?\n * @param {OnMore} props.renderMoreMenu - Callback to render additional items in the more menu\n */\nconst BlockEditorToolbar = ( props ) => {\n\tconst ref = useRef( null );\n\tconst { settings, editorMode, renderMoreMenu } = props;\n\tconst isHugeViewport = useViewportMatch( 'huge', '>=' );\n\tconst blockToolbarRef = useRef();\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst { inspector } = settings.iso?.toolbar || {};\n\tconst { moreMenu } = settings.iso || {};\n\tconst inspectorInSidebar = settings?.iso?.sidebar?.inspector || false;\n\tconst { openGeneralSidebar, closeGeneralSidebar } = useDispatch( 'isolated/editor' );\n\tconst { setIsInserterOpened } = useDispatch( 'isolated/editor' );\n\tconst { isEditorSidebarOpened, isBlockSelected, hasBlockSelected, isInserterOpened, isEditing } = useSelect(\n\t\t( select ) => ( {\n\t\t\tisEditing: select( 'isolated/editor' ),\n\t\t\t// @ts-ignore\n\t\t\tisEditorSidebarOpened: select( 'isolated/editor' ).isEditorSidebarOpened(),\n\t\t\t// @ts-ignore\n\t\t\tisBlockSelected: !! select( 'core/block-editor' ).getBlockSelectionStart(),\n\t\t\t// @ts-ignore\n\t\t\thasBlockSelected: !! select( 'core/block-editor' ).getBlockSelectionStart(),\n\t\t\t// @ts-ignore\n\t\t\tisInserterOpened: select( 'isolated/editor' ).isInserterOpened(),\n\t\t} ),\n\t\t[]\n\t);\n\n\tconst [ isBlockToolsCollapsed, setIsBlockToolsCollapsed ] =\n\t\tuseState( true );\n\n\tuseEffect( () => {\n\t\t// If we have a new block selection, show the block tools\n\t\tif ( isBlockSelected ) {\n\t\t\tsetIsBlockToolsCollapsed( false );\n\t\t}\n\t}, [ isBlockSelected ] );\n\n\tfunction toggleSidebar( isOpen ) {\n\t\tif ( ! isOpen ) {\n\t\t\tcloseGeneralSidebar();\n\t\t} else {\n\t\t\topenGeneralSidebar( hasBlockSelected ? 'edit-post/block' : 'edit-post/document' );\n\t\t}\n\t}\n\n\t// If in popover mode then ensure the sidebar is closed when the editor is first started. This is because the complimentary area status\n\t// is saved to localStorage, and it might have been left open when in sidebar mode.\n\tuseEffect( () => {\n\t\tif ( ! inspectorInSidebar ) {\n\t\t\tcloseGeneralSidebar();\n\t\t}\n\t}, [] );\n\n\tuseEffect( () => {\n\t\t// Close the block inspector when no block is selected. Gutenberg gets a bit crashy otherwise\n\t\tif ( ! inspectorInSidebar && ! isEditing && ! isBlockSelected && isEditorSidebarOpened ) {\n\t\t\tcloseGeneralSidebar();\n\t\t}\n\t}, [ isEditing ] );\n\n\t// Inserter and Sidebars are mutually exclusive\n\tuseEffect( () => {\n\t\tif ( isEditorSidebarOpened && ! isHugeViewport ) {\n\t\t\tsetIsInserterOpened( false );\n\t\t}\n\t}, [ isEditorSidebarOpened, isHugeViewport ] );\n\tuseEffect( () => {\n\t\tif ( isInserterOpened && ( ! isHugeViewport || ! inspectorInSidebar ) ) {\n\t\t\tcloseGeneralSidebar();\n\t\t}\n\t}, [ isInserterOpened, isHugeViewport ] );\n\n\treturn (\n\t\t<div className=\"edit-post-editor-regions__header\" role=\"region\" tabIndex={ -1 }>\n\t\t\t<div className=\"edit-post-header\">\n\t\t\t\t<div className=\"edit-post-header__toolbar\">\n\t\t\t\t\t<HeaderToolbar settings={ settings } />\n\t\t\t\t\t{ isLargeViewport && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t\t\t'selected-block-tools-wrapper',\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t'is-collapsed': isBlockToolsCollapsed,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockToolbar hideDragHandle />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\t<Popover.Slot\n\t\t\t\t\t\t\t\t\tref={ blockToolbarRef }\n\t\t\t\t\t\t\t\t\tname=\"block-toolbar\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t{ isBlockSelected && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tclassName=\"edit-post-header__block-tools-toggle\"\n\t\t\t\t\t\t\t\t\ticon={ isBlockToolsCollapsed ? next : previous }\n\t\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\t\tsetIsBlockToolsCollapsed(\n\t\t\t\t\t\t\t\t\t\t\t( collapsed ) => ! collapsed\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\t\tisBlockToolsCollapsed\n\t\t\t\t\t\t\t\t\t\t\t? __( 'Show block tools' )\n\t\t\t\t\t\t\t\t\t\t\t: __( 'Hide block tools' )\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"edit-post-header__settings\" ref={ ref }>\n\t\t\t\t\t<ToolbarSlot.Slot />\n\n\t\t\t\t\t{ inspector && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ticon={ cog }\n\t\t\t\t\t\t\tlabel={ __( 'Settings' ) }\n\t\t\t\t\t\t\tonClick={ () => toggleSidebar( ! isEditorSidebarOpened ) }\n\t\t\t\t\t\t\tisPressed={ isEditorSidebarOpened }\n\t\t\t\t\t\t\taria-expanded={ isEditorSidebarOpened }\n\t\t\t\t\t\t\tdisabled={ editorMode === 'text' }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ isEditorSidebarOpened && ! inspectorInSidebar && (\n\t\t\t\t\t\t<Inspector button={ ref } onToggle={ toggleSidebar } />\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ moreMenu && (\n\t\t\t\t\t\t<MoreMenu\n\t\t\t\t\t\t\tsettings={ settings }\n\t\t\t\t\t\t\tonClick={ () => closeGeneralSidebar() }\n\t\t\t\t\t\t\trenderMoreMenu={ renderMoreMenu }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default BlockEditorToolbar;\n"],"mappings":"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"}