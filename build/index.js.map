{"version":3,"file":"index.js","names":["require","_element","_components","_blockLibrary","_data","_keyboardShortcuts","_blockEditorContainer","_interopRequireDefault","_withRegistryProvider","_editorSetup","_patternMonitor","_contentSaver","_apiFetch","_storeHotSwap","_document","_slot","_actionArea","_footerSlot","_editorLoaded","_editorHeadingSlot","_excluded","createElement","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty2","getOwnPropertyDescriptors","defineProperties","defineProperty","initializeEditor","window","isoInitialised","registerCoreBlocks","useInitializeIsoEditor","_ref","undefined","undoManager","isoInitialisedBlocks","use","storeHotSwapPlugin","registerApiHandlers","IsolatedBlockEditor","props","children","onSaveContent","onSaveBlocks","__experimentalUndoManager","__experimentalOnInput","__experimentalOnChange","__experimentalValue","__experimentalOnSelection","params","_objectWithoutProperties2","settings","useEditorSetup","editorSelection","useSelect","select","start","getSelectionStart","end","getSelectionEnd","useEffect","StrictMode","SlotFillProvider","onInput","onChange","blocks","_default","exports","withRegistryProvider"],"sources":["../src/index.js"],"sourcesContent":["// @ts-nocheck\n/**\n * WordPress dependencies\n */\n\nimport '@wordpress/editor';\nimport { StrictMode, useEffect } from '@wordpress/element';\nimport { SlotFillProvider } from '@wordpress/components';\nimport { registerCoreBlocks } from '@wordpress/block-library';\nimport { use, useDispatch, useSelect } from '@wordpress/data';\nimport '@wordpress/format-library';\nimport { ShortcutProvider } from '@wordpress/keyboard-shortcuts';\n\n/**\n * Internal dependencies\n */\n\nimport BlockEditorContainer from './components/block-editor-container';\nimport withRegistryProvider from './components/with-registry-provider';\nimport useEditorSetup from './components/editor-setup';\nimport PatternMonitor from './components/pattern-monitor';\nimport ContentSaver from './components/content-saver';\nimport registerApiHandlers from './components/api-fetch';\nimport storeHotSwapPlugin from './store/plugins/store-hot-swap';\nimport DocumentSection from './components/document';\nimport ToolbarSlot from './components/block-editor-toolbar/slot';\nimport ActionArea from './components/action-area';\nimport FooterSlot from './components/footer-slot';\n\n// Export library components\nimport EditorLoaded from './components/editor-loaded';\nimport EditorHeadingSlot from './components/editor-heading-slot';\n\n// A fake edit-post store is needed\nimport './store/edit-post';\nimport './style.scss';\n\n/** @typedef {import('./components/block-editor-toolbar/more-menu').OnMore} OnMore */\n/** @typedef {import('./store/editor/reducer').Pattern} Pattern */\n/** @typedef {import('./components/block-editor-contents/index').OnUpdate} OnUpdate */\n\n/**\n * Undo Manager\n *\n * @typedef UndoManager\n * @property {Function} undo - Undo callback\n * @property {Function} redo - redoCallback\n * @property {Array} undoStack - Undo stack\n * @property {Array} redoStack - Redo stack\n */\n\n/**\n * Toolbar settings\n *\n * @typedef ToolbarSettings\n * @property {boolean} [inserter] - Enable or disable the toolbar block inserter\n * @property {boolean} [inspector] - Enable or disable the toolbar block inspector\n * @property {boolean} [navigation] - Enable or disable the toolbar navigation button\n * @property {boolean} [undo] - Enable or disable the toolbar undo/redo buttons\n * @property {boolean} [selectorTool] - Enable or disable the selector tool\n * @property {boolean|string} [documentInspector] - Enable or disable the document inspector or enable with custom label\n */\n\n/**\n * More menu settings\n *\n * @typedef MoreMenuSettings\n * @property {boolean} [editor] - Enable or disable the editor sub menu (visual/code editing)\n * @property {boolean} [fullscreen] - Enable or disable the fullscreen option\n * @property {boolean} [preview] - Enable or disable the preview option\n * @property {boolean} [topToolbar] - Enable or disable the 'top toolbar' option\n */\n\n/**\n * Sidebar settings\n *\n * @typedef SidebarSettings\n * @property {boolean} [inspector=false] - Display the block inspector in a sidebar (true) or popover (false)\n * @property {boolean} [inserter=false] - Display the block inserter in a sidebar (true) or popover (false)\n * @property {function|null} [customComponent] - Function returning a custom sidebar component, or will default to the block inspector\n */\n\n/**\n * Isolated Editor Settings\n *\n * @typedef IsoSettings\n * @property {string|null} [preferencesKey] - Preferences key. Set to null to disable\n * @property {string|null} [persistenceKey] - Persistence key. Set to null to disable\n * @property {{allowBlocks: string[], disallowBlocks: string[]}} [blocks] - Block restrictions\n * @property {string[]} [disallowEmbed] - List of embed names to remove\n * @property {object[]} [customStores] - Array of custom stores\n * @property {boolean} [footer] - Show footer component\n * @property {boolean} [header] - Show header component\n * @property {ToolbarSettings} [toolbar] - Toolbar settings\n * @property {MoreMenuSettings|false} [moreMenu] - More menu settings, or false to disable\n * @property {{title: string, url: string}[]} [linkMenu] - Link menu settings\n * @property {string|null} [currentPattern] - The pattern to start with\n * @property {Pattern[]} [patterns] - List of patterns\n * @property {Object} [defaultPreferences] - Default preferences if nothing in localStorage\n * @property {boolean} [allowApi] - Allow API requests\n * @property {boolean} [disableCanvasAnimations] - Disable editor canvas animations\n * @property {SidebarSettings} [sidebar] - Configure sidebar functionality\n */\n\n/**\n * Block Editor Settings\n *\n * @typedef BlockEditorSettings\n * @property {IsoSettings} [iso] - Isolated editor settings\n * @property {EditorSettings} [editor] - Gutenberg editor settings\n */\n\n/**\n * Gutenberg Editor Settings - this isn't the complete object, but just enough for linting here\n *\n * @typedef EditorSettings\n * @property {boolean} hasUploadPermissions\n * @property {Object} allowedMimeTypes\n * @property {string[]} allowedBlockTypes\n * @property {boolean} fixedToolbar\n * @property {boolean} hasFixedToolbar\n * @property {object[]|null} template\n * @property {null} templateLock\n * @property {object[]} reusableBlocks\n * @property {object[]} styles\n * @property {object[]} defaultEditorStyles\n * @property {string} bodyPlaceholder\n */\n\n/**\n * OnSelect callback\n *\n * @callback OnSelect\n * @param {Object} selection - Editor content to save\n */\n\n/**\n * Initialize Gutenberg\n */\nexport function initializeEditor() {\n\tif ( window.isoInitialised ) {\n\t\treturn;\n\t}\n\n\t// Register all core blocks\n\tregisterCoreBlocks();\n\n\twindow.isoInitialised = true;\n}\n/**\n * @param {Object} props - Component props\n * @param {UndoManager} [props.undoManager]\n */\nexport function useInitializeIsoEditor( { undoManager } = {} ) {\n\tif ( window.isoInitialisedBlocks ) {\n\t\treturn;\n\t}\n\n\tinitializeEditor();\n\n\t// This allows the editor to swap stores dynamically\n\tuse( storeHotSwapPlugin, {} );\n\n\tregisterApiHandlers();\n\n\t// Don't run this again\n\twindow.isoInitialisedBlocks = true;\n}\n\n/**\n * Save blocks callback\n *\n * @callback OnSaveBlocks\n * @param {object[]} blocks - Editor content to save\n * @param {string[]} ignoredContent - Possible content to ignore\n */\n\n/**\n * Save HTML content callback\n *\n * @callback OnSaveContent\n * @param {string} content - Serialized content\n */\n\n/**\n * Parser callback\n *\n * @callback OnParse\n * @param {string} content - HTML content\n * @return {object[]}\n */\n\n/**\n * Initial load blocks callback\n *\n * @callback OnLoad\n * @param {OnParse} parse - Current block parser\n * @param {OnParse} rawHandler - Current raw handler\n * @return {object[]|Promise}\n */\n\n/**\n * Error callback\n *\n * @callback OnError\n */\n\n/**\n * Isolated block editor component.\n *\n * This wraps up the Gutenberg editor along with a customised store. The contents of the editor are unique, and multiple instances\n * can be created.\n *\n * @param {Object} props - Component props\n * @param {OnSaveBlocks} [props.onSaveBlocks] - Save callback\n * @param {OnSaveContent} [props.onSaveContent] - Save callback\n * @param {OnError} props.onError - Error callback\n * @param {OnLoad} [props.onLoad] - Initial blocks\n * @param {BlockEditorSettings} props.settings - Settings\n * @param {Object} [props.children] - Child content\n * @param {string} [props.className] - Additional class name\n * @param {OnMore} [props.renderMoreMenu] - Callback to render additional items in the more menu\n * @param {UndoManager} [props.__experimentalUndoManager] - Undo manager\n * @param {OnUpdate} [props.__experimentalOnInput] - Gutenberg's onInput callback\n * @param {OnUpdate} [props.__experimentalOnChange] - Gutenberg's onChange callback\n * @param {OnSelect} [props.__experimentalOnSelection] - Callback to run when the editor selection changes\n * @param {object[]} [props.__experimentalValue] - Gutenberg's value\n */\nfunction IsolatedBlockEditor( props ) {\n\tconst {\n\t\tchildren,\n\t\tonSaveContent,\n\t\tonSaveBlocks,\n\t\t__experimentalUndoManager,\n\t\t__experimentalOnInput,\n\t\t__experimentalOnChange,\n\t\t__experimentalValue,\n\t\t__experimentalOnSelection,\n\t\t...params\n\t} = props;\n\n\t// This needs to happen first to setup Gutenbergy things\n\tuseInitializeIsoEditor( { undoManager: __experimentalUndoManager } );\n\n\tconst settings = useEditorSetup( props.settings );\n\tconst editorSelection = useSelect(\n\t\t( select ) => ( {\n\t\t\tstart: select( 'core/block-editor' ).getSelectionStart(),\n\t\t\tend: select( 'core/block-editor' ).getSelectionEnd(),\n\t\t} ),\n\t\t[]\n\t);\n\n\tuseEffect( () => {\n\t\t__experimentalOnSelection?.( editorSelection );\n\t}, [ editorSelection ] );\n\n\treturn (\n\t\t<StrictMode>\n\t\t\t<ContentSaver onSaveBlocks={ onSaveBlocks } onSaveContent={ onSaveContent } />\n\t\t\t<PatternMonitor />\n\n\t\t\t<SlotFillProvider>\n\t\t\t\t<BlockEditorContainer\n\t\t\t\t\t{ ...params }\n\t\t\t\t\tonInput={ __experimentalOnInput }\n\t\t\t\t\tonChange={ __experimentalOnChange }\n\t\t\t\t\tblocks={ __experimentalValue }\n\t\t\t\t\tsettings={ settings }\n\t\t\t\t>\n\t\t\t\t\t{ children }\n\t\t\t\t</BlockEditorContainer>\n\t\t\t</SlotFillProvider>\n\t\t</StrictMode>\n\t);\n}\n\nexport default withRegistryProvider( IsolatedBlockEditor );\n\nexport { EditorLoaded, DocumentSection, ToolbarSlot, FooterSlot, EditorHeadingSlot, ActionArea };\n"],"mappings":"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"}