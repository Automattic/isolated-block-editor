{"version":3,"file":"index.js","names":["useViewportMatch","useSelect","useDispatch","__","_x","ToolbarItem","Button","Popover","NavigableToolbar","__experimentalLibrary","Library","ToolSelector","plus","listView","useRef","useCallback","store","keyboardShortcutsStore","EditorHistoryRedo","EditorHistoryUndo","BlockNavigationDropdown","preventDefault","event","HeaderToolbar","props","_props$settings","_props$settings$iso","_props$settings$iso$s","inserterButton","setIsInserterOpened","setIsListViewOpened","isMobileViewport","hasFixedToolbar","isInserterEnabled","isTextModeEnabled","showIconLabels","previewDeviceType","isInserterOpened","isListViewOpen","listViewShortcut","select","hasInserterItems","getBlockRootClientId","getBlockSelectionEnd","isListViewOpened","getShortcutRepresentation","isFeatureActive","getEditorMode","getEditorSettings","richEditingEnabled","isLargeViewport","inserter","navigation","undo","selectorTool","settings","iso","toolbar","inserterInSidebar","sidebar","displayBlockToolbar","toolbarAriaLabel","openInserter","toggleListView","createElement","className","ref","as","isPressed","onMouseDown","onClick","disabled","isPrimary","icon","label","showTooltip","position","onClose","anchor","current","showMostUsedBlocks","showInserterHelpPanel","onSelect","variant","undefined","isDisabled","shortcut"],"sources":["../../../../src/components/block-editor-toolbar/header-toolbar/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useViewportMatch } from '@wordpress/compose';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { __, _x } from '@wordpress/i18n';\nimport { ToolbarItem, Button, Popover } from '@wordpress/components';\nimport { NavigableToolbar, __experimentalLibrary as Library, ToolSelector } from '@wordpress/block-editor';\nimport { plus, listView } from '@wordpress/icons';\nimport { useRef, useCallback } from '@wordpress/element';\nimport { store as keyboardShortcutsStore } from '@wordpress/keyboard-shortcuts';\n\n/**\n * Internal dependencies\n */\nimport EditorHistoryRedo from './redo';\nimport EditorHistoryUndo from './undo';\nimport BlockNavigationDropdown from '../block-navigation';\n\nconst preventDefault = ( event ) => {\n\tevent.preventDefault();\n};\n\nfunction HeaderToolbar( props ) {\n\tconst inserterButton = useRef();\n\tconst { setIsInserterOpened, setIsListViewOpened } = useDispatch( 'isolated/editor' );\n\tconst isMobileViewport = useViewportMatch( 'medium', '<' );\n\tconst {\n\t\thasFixedToolbar,\n\t\tisInserterEnabled,\n\t\tisTextModeEnabled,\n\t\tshowIconLabels,\n\t\tpreviewDeviceType,\n\t\tisInserterOpened,\n\t\tisListViewOpen,\n\t\tlistViewShortcut,\n\t} = useSelect( ( select ) => {\n\t\tconst { hasInserterItems, getBlockRootClientId, getBlockSelectionEnd } = select( 'core/block-editor' );\n\t\tconst { isListViewOpened } = select( 'isolated/editor' );\n\t\t// @ts-ignore\n\t\tconst { getShortcutRepresentation } = select( keyboardShortcutsStore );\n\n\t\treturn {\n\t\t\t// @ts-ignore\n\t\t\thasFixedToolbar: select( 'isolated/editor' ).isFeatureActive( 'fixedToolbar' ),\n\t\t\t// This setting (richEditingEnabled) should not live in the block editor's setting.\n\t\t\tisInserterEnabled:\n\t\t\t\t// @ts-ignore\n\t\t\t\tselect( 'isolated/editor' ).getEditorMode() === 'visual' &&\n\t\t\t\t// @ts-ignore\n\t\t\t\tselect( 'core/editor' ).getEditorSettings().richEditingEnabled &&\n\t\t\t\t// @ts-ignore\n\t\t\t\thasInserterItems( getBlockRootClientId( getBlockSelectionEnd() ) ),\n\t\t\t// @ts-ignore\n\t\t\tisListViewOpen: isListViewOpened(),\n\t\t\t// @ts-ignore\n\t\t\tisTextModeEnabled: select( 'isolated/editor' ).getEditorMode() === 'text',\n\t\t\tpreviewDeviceType: 'Desktop',\n\t\t\t// @ts-ignore\n\t\t\tisInserterOpened: select( 'isolated/editor' ).isInserterOpened(),\n\t\t\tshowIconLabels: false, // Not implemented yet\n\t\t\tlistViewShortcut: getShortcutRepresentation( 'core/edit-post/toggle-list-view' ),\n\t\t};\n\t}, [] );\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst { inserter, navigation, undo, selectorTool } = props.settings.iso.toolbar;\n\tconst inserterInSidebar = props.settings?.iso?.sidebar?.inserter || false;\n\tconst displayBlockToolbar = !isLargeViewport || previewDeviceType !== 'Desktop' || hasFixedToolbar;\n\tconst toolbarAriaLabel = displayBlockToolbar\n\t\t? /* translators: accessibility text for the editor toolbar when Top Toolbar is on */\n\t\t__( 'Document and block tools' )\n\t\t: /* translators: accessibility text for the editor toolbar when Top Toolbar is off */\n\t\t__( 'Document tools' );\n\tconst openInserter = useCallback( () => {\n\t\tif ( isInserterOpened ) {\n\t\t\t// Focusing the inserter button closes the inserter popover\n\t\t\t// @ts-ignore\n\t\t\tsetIsInserterOpened( false );\n\t\t} else {\n\t\t\tsetIsInserterOpened( true );\n\t\t}\n\t}, [ isInserterOpened, setIsInserterOpened ] );\n\n\tconst toggleListView = useCallback( () => setIsListViewOpened( !isListViewOpen ), [\n\t\tsetIsListViewOpened,\n\t\tisListViewOpen,\n\t] );\n\n\treturn (\n\t\t<NavigableToolbar className=\"edit-post-header-toolbar\" aria-label={ toolbarAriaLabel }>\n\t\t\t{ ( inserter || undo || navigation || selectorTool ) && (\n\t\t\t\t<div className=\"edit-post-header-toolbar__left\">\n\t\t\t\t\t{ inserter && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tref={ inserterButton }\n\t\t\t\t\t\t\tas={ Button }\n\t\t\t\t\t\t\tclassName=\"edit-post-header-toolbar__inserter-toggle\"\n\t\t\t\t\t\t\tisPressed={ isInserterOpened }\n\t\t\t\t\t\t\tonMouseDown={ preventDefault }\n\t\t\t\t\t\t\tonClick={ openInserter }\n\t\t\t\t\t\t\tdisabled={ !isInserterEnabled }\n\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\ticon={ plus }\n\t\t\t\t\t\t\t/* translators: button label text should, if possible, be under 16\n\t\t\t\t\tcharacters. */\n\t\t\t\t\t\t\tlabel={ _x( 'Toggle block inserter', 'Generic label for block inserter button' ) }\n\t\t\t\t\t\t\tshowTooltip={ !showIconLabels }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ isInserterOpened && !inserterInSidebar && (\n\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\tposition=\"bottom right\"\n\t\t\t\t\t\t\tonClose={ () => setIsInserterOpened( false ) }\n\t\t\t\t\t\t\tanchor={ inserterButton.current }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Library\n\t\t\t\t\t\t\t\tshowMostUsedBlocks={ false }\n\t\t\t\t\t\t\t\tshowInserterHelpPanel\n\t\t\t\t\t\t\t\tonSelect={ () => {\n\t\t\t\t\t\t\t\t\tif ( isMobileViewport ) {\n\t\t\t\t\t\t\t\t\t\tsetIsInserterOpened( false );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Popover>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ selectorTool && <ToolSelector /> }\n\t\t\t\t\t{ undo && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ EditorHistoryUndo }\n\t\t\t\t\t\t\tshowTooltip={ !showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ undo && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ EditorHistoryRedo }\n\t\t\t\t\t\t\tshowTooltip={ !showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ navigation && !inserterInSidebar && (\n\t\t\t\t\t\t<ToolbarItem as={ BlockNavigationDropdown } isDisabled={ isTextModeEnabled } />\n\t\t\t\t\t) }\n\t\t\t\t\t{ navigation && inserterInSidebar && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ Button }\n\t\t\t\t\t\t\tclassName=\"edit-post-header-toolbar__list-view-toggle\"\n\t\t\t\t\t\t\ticon={ listView }\n\t\t\t\t\t\t\tdisabled={ isTextModeEnabled }\n\t\t\t\t\t\t\tisPressed={ isListViewOpen }\n\t\t\t\t\t\t\t/* translators: button label text should, if possible, be under 16 characters. */\n\t\t\t\t\t\t\tlabel={ __( 'List View' ) }\n\t\t\t\t\t\t\tonClick={ toggleListView }\n\t\t\t\t\t\t\tshortcut={ listViewShortcut }\n\t\t\t\t\t\t\tshowTooltip={ !showIconLabels }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t) }\n\t\t</NavigableToolbar>\n\t);\n}\n\nexport default HeaderToolbar;\n"],"mappings":"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"}