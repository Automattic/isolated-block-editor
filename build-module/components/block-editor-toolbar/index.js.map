{"version":3,"file":"index.js","names":["BlockToolbar","useEffect","useRef","useState","Button","Popover","cog","next","previous","__","useSelect","useDispatch","useViewportMatch","classnames","MoreMenu","HeaderToolbar","Inspector","ToolbarSlot","BlockEditorToolbar","props","ref","settings","editorMode","renderMoreMenu","isHugeViewport","blockToolbarRef","isLargeViewport","inspector","iso","toolbar","moreMenu","inspectorInSidebar","sidebar","openGeneralSidebar","closeGeneralSidebar","setIsInserterOpened","isEditorSidebarOpened","isBlockSelected","hasBlockSelected","isInserterOpened","isEditing","select","getBlockSelectionStart","isBlockToolsCollapsed","setIsBlockToolsCollapsed","toggleSidebar","isOpen","createElement","className","role","tabIndex","Fragment","hideDragHandle","Slot","name","icon","onClick","collapsed","label","isPressed","disabled","button","onToggle"],"sources":["../../../src/components/block-editor-toolbar/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\n\nimport {\tBlockToolbar } from '@wordpress/block-editor';\nimport { useEffect, useRef, useState } from '@wordpress/element';\nimport { Button, Popover } from '@wordpress/components';\nimport { cog, next, previous } from '@wordpress/icons';\nimport { __ } from '@wordpress/i18n';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { useViewportMatch } from '@wordpress/compose';\n\n/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * Internal dependencies\n */\nimport MoreMenu from './more-menu';\nimport HeaderToolbar from './header-toolbar';\nimport Inspector from './inspector';\nimport ToolbarSlot from './slot';\nimport './style.scss';\n\n/** @typedef {import('../../store/editor/reducer').EditorMode} EditorMode */\n/** @typedef {import('../../index').BlockEditorSettings} BlockEditorSettings */\n/** @typedef {import('../../index').OnMore} OnMore */\n\n/**\n * Block editor toolbar\n *\n * @param {Object} props - Component props\n * @param {BlockEditorSettings} props.settings - Settings\n * @param {EditorMode} props.editorMode - Visual or code?\n * @param {OnMore} props.renderMoreMenu - Callback to render additional items in the more menu\n */\nconst BlockEditorToolbar = ( props ) => {\n\tconst ref = useRef( null );\n\tconst { settings, editorMode, renderMoreMenu } = props;\n\tconst isHugeViewport = useViewportMatch( 'huge', '>=' );\n\tconst blockToolbarRef = useRef();\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst { inspector } = settings.iso?.toolbar || {};\n\tconst { moreMenu } = settings.iso || {};\n\tconst inspectorInSidebar = settings?.iso?.sidebar?.inspector || false;\n\tconst { openGeneralSidebar, closeGeneralSidebar } = useDispatch( 'isolated/editor' );\n\tconst { setIsInserterOpened } = useDispatch( 'isolated/editor' );\n\tconst { isEditorSidebarOpened, isBlockSelected, hasBlockSelected, isInserterOpened, isEditing } = useSelect(\n\t\t( select ) => ( {\n\t\t\tisEditing: select( 'isolated/editor' ),\n\t\t\t// @ts-ignore\n\t\t\tisEditorSidebarOpened: select( 'isolated/editor' ).isEditorSidebarOpened(),\n\t\t\t// @ts-ignore\n\t\t\tisBlockSelected: !! select( 'core/block-editor' ).getBlockSelectionStart(),\n\t\t\t// @ts-ignore\n\t\t\thasBlockSelected: !! select( 'core/block-editor' ).getBlockSelectionStart(),\n\t\t\t// @ts-ignore\n\t\t\tisInserterOpened: select( 'isolated/editor' ).isInserterOpened(),\n\t\t} ),\n\t\t[]\n\t);\n\n\tconst [ isBlockToolsCollapsed, setIsBlockToolsCollapsed ] =\n\t\tuseState( true );\n\n\tuseEffect( () => {\n\t\t// If we have a new block selection, show the block tools\n\t\tif ( isBlockSelected ) {\n\t\t\tsetIsBlockToolsCollapsed( false );\n\t\t}\n\t}, [ isBlockSelected ] );\n\n\tfunction toggleSidebar( isOpen ) {\n\t\tif ( ! isOpen ) {\n\t\t\tcloseGeneralSidebar();\n\t\t} else {\n\t\t\topenGeneralSidebar( hasBlockSelected ? 'edit-post/block' : 'edit-post/document' );\n\t\t}\n\t}\n\n\t// If in popover mode then ensure the sidebar is closed when the editor is first started. This is because the complimentary area status\n\t// is saved to localStorage, and it might have been left open when in sidebar mode.\n\tuseEffect( () => {\n\t\tif ( ! inspectorInSidebar ) {\n\t\t\tcloseGeneralSidebar();\n\t\t}\n\t}, [] );\n\n\tuseEffect( () => {\n\t\t// Close the block inspector when no block is selected. Gutenberg gets a bit crashy otherwise\n\t\tif ( ! inspectorInSidebar && ! isEditing && ! isBlockSelected && isEditorSidebarOpened ) {\n\t\t\tcloseGeneralSidebar();\n\t\t}\n\t}, [ isEditing ] );\n\n\t// Inserter and Sidebars are mutually exclusive\n\tuseEffect( () => {\n\t\tif ( isEditorSidebarOpened && ! isHugeViewport ) {\n\t\t\tsetIsInserterOpened( false );\n\t\t}\n\t}, [ isEditorSidebarOpened, isHugeViewport ] );\n\tuseEffect( () => {\n\t\tif ( isInserterOpened && ( ! isHugeViewport || ! inspectorInSidebar ) ) {\n\t\t\tcloseGeneralSidebar();\n\t\t}\n\t}, [ isInserterOpened, isHugeViewport ] );\n\n\treturn (\n\t\t<div className=\"edit-post-editor-regions__header\" role=\"region\" tabIndex={ -1 }>\n\t\t\t<div className=\"edit-post-header\">\n\t\t\t\t<div className=\"edit-post-header__toolbar\">\n\t\t\t\t\t<HeaderToolbar settings={ settings } />\n\t\t\t\t\t{ isLargeViewport && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t\t\t'selected-block-tools-wrapper',\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t'is-collapsed': isBlockToolsCollapsed,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockToolbar hideDragHandle />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\t<Popover.Slot\n\t\t\t\t\t\t\t\t\tref={ blockToolbarRef }\n\t\t\t\t\t\t\t\t\tname=\"block-toolbar\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t{ isBlockSelected && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tclassName=\"edit-post-header__block-tools-toggle\"\n\t\t\t\t\t\t\t\t\ticon={ isBlockToolsCollapsed ? next : previous }\n\t\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\t\tsetIsBlockToolsCollapsed(\n\t\t\t\t\t\t\t\t\t\t\t( collapsed ) => ! collapsed\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\t\tisBlockToolsCollapsed\n\t\t\t\t\t\t\t\t\t\t\t? __( 'Show block tools' )\n\t\t\t\t\t\t\t\t\t\t\t: __( 'Hide block tools' )\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"edit-post-header__settings\" ref={ ref }>\n\t\t\t\t\t<ToolbarSlot.Slot />\n\n\t\t\t\t\t{ inspector && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ticon={ cog }\n\t\t\t\t\t\t\tlabel={ __( 'Settings' ) }\n\t\t\t\t\t\t\tonClick={ () => toggleSidebar( ! isEditorSidebarOpened ) }\n\t\t\t\t\t\t\tisPressed={ isEditorSidebarOpened }\n\t\t\t\t\t\t\taria-expanded={ isEditorSidebarOpened }\n\t\t\t\t\t\t\tdisabled={ editorMode === 'text' }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ isEditorSidebarOpened && ! inspectorInSidebar && (\n\t\t\t\t\t\t<Inspector button={ ref } onToggle={ toggleSidebar } />\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ moreMenu && (\n\t\t\t\t\t\t<MoreMenu\n\t\t\t\t\t\t\tsettings={ settings }\n\t\t\t\t\t\t\tonClick={ () => closeGeneralSidebar() }\n\t\t\t\t\t\t\trenderMoreMenu={ renderMoreMenu }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default BlockEditorToolbar;\n"],"mappings":"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"}