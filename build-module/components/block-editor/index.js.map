{"version":3,"file":"index.js","names":["classnames","withDispatch","useSelect","KeyboardShortcuts","rawShortcut","useViewportMatch","BlockEditorKeyboardShortcuts","BlockToolbar","EditorNotices","EditorSnackbars","FullscreenMode","ComplementaryArea","InterfaceSkeleton","store","interfaceStore","__","keyboardShortcutsStore","useEffect","SettingsSidebar","VisualEditor","TextEditor","BlockEditorToolbar","InserterSidebar","ListViewSidebar","Footer","ActionArea","interfaceLabels","secondarySidebar","header","body","sidebar","actions","footer","BlockEditor","props","_settings$iso$header","_settings$iso$sidebar","_settings$iso$toolbar","isEditing","editorMode","children","undo","redo","settings","renderMoreMenu","styles","isMobileViewport","isLargeViewport","inspectorInSidebar","iso","inspector","inserterInSidebar","inserter","showHeader","showFooter","sidebarIsOpened","fixedToolbar","isInserterOpened","isListViewOpened","showIconLabels","isFullscreenActive","previousShortcut","nextShortcut","select","isFeatureActive","isOptionActive","getActiveComplementaryArea","editor","hasFixedToolbar","getAllShortcutKeyCombinations","className","createElement","html","document","querySelector","classList","add","remove","CustomSettingsSidebar","customComponent","Fragment","documentInspector","toolbar","isActive","labels","Slot","scope","notices","content","Register","bindGlobal","shortcuts","primary","primaryShift","hideDragHandle","previous","next","dispatch"],"sources":["../../../src/components/block-editor/index.js"],"sourcesContent":["// @ts-nocheck\n/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { withDispatch, useSelect } from '@wordpress/data';\nimport { KeyboardShortcuts } from '@wordpress/components';\nimport { rawShortcut } from '@wordpress/keycodes';\nimport { useViewportMatch } from '@wordpress/compose';\nimport { BlockEditorKeyboardShortcuts, BlockToolbar } from '@wordpress/block-editor';\nimport { EditorNotices, EditorSnackbars } from '@wordpress/editor';\nimport { FullscreenMode, ComplementaryArea, InterfaceSkeleton, store as interfaceStore } from '@wordpress/interface';\nimport { __ } from '@wordpress/i18n';\nimport { store as keyboardShortcutsStore } from '@wordpress/keyboard-shortcuts';\nimport { useEffect } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport SettingsSidebar from './sidebar';\nimport VisualEditor from './visual-editor';\nimport TextEditor from './text-editor';\nimport './style.scss';\nimport BlockEditorToolbar from '../block-editor-toolbar';\nimport InserterSidebar from './inserter-sidebar';\nimport ListViewSidebar from './listview-sidebar';\nimport Footer from './footer';\nimport ActionArea from '../action-area';\n\n/** @typedef {import('../../store/editor/reducer').EditorMode} EditorMode */\n/** @typedef {import('../../index').BlockEditorSettings} BlockEditorSettings */\n/** @typedef {import('../../index').OnMore} OnMore */\n\n/**\n * Undo/redo\n *\n * @callback OnHistory\n */\n\nconst interfaceLabels = {\n\tsecondarySidebar: __( 'Block library' ),\n\t/* translators: accessibility text for the editor top bar landmark region. */\n\theader: __( 'Editor top bar' ),\n\t/* translators: accessibility text for the editor content landmark region. */\n\tbody: __( 'Editor content' ),\n\t/* translators: accessibility text for the editor settings landmark region. */\n\tsidebar: __( 'Editor settings' ),\n\t/* translators: accessibility text for the editor publish landmark region. */\n\tactions: __( 'Editor publish' ),\n\t/* translators: accessibility text for the editor footer landmark region. */\n\tfooter: __( 'Editor footer' ),\n};\n\n/**\n * The editor component. Contains the visual or text editor, along with keyboard handling.\n *\n * Note: the keyboard handling is specific to this editor and *not* global\n *\n * @param {Object} props - Component props\n * @param {boolean} props.isEditing - Are we editing in this editor?\n * @param {EditorMode} props.editorMode - Visual or code?\n * @param {BlockEditorSettings} props.settings - Settings\n * @param {Object} props.children - Child components\n * @param {OnHistory} props.undo\n * @param {OnHistory} props.redo\n * @param {OnMore} props.renderMoreMenu - Callback to render additional items in the more menu\n */\nfunction BlockEditor( props ) {\n\tconst { isEditing, editorMode, children, undo, redo, settings, renderMoreMenu } = props;\n\tconst styles = []; // TODO: do we need hasThemeStyles support here?\n\tconst isMobileViewport = useViewportMatch( 'medium', '<' );\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst inspectorInSidebar = settings?.iso?.sidebar?.inspector || false;\n\tconst inserterInSidebar = settings?.iso?.sidebar?.inserter || false;\n\tconst showHeader = settings?.iso?.header ?? true;\n\tconst showFooter = settings?.iso?.footer || false;\n\tconst {\n\t\tsidebarIsOpened,\n\t\tfixedToolbar,\n\t\tisInserterOpened,\n\t\tisListViewOpened,\n\t\tshowIconLabels,\n\t\tisFullscreenActive,\n\t\tpreviousShortcut,\n\t\tnextShortcut,\n\t} = useSelect( ( select ) => {\n\t\tconst { isFeatureActive, isInserterOpened, isListViewOpened, isOptionActive } = select( 'isolated/editor' );\n\n\t\treturn {\n\t\t\tsidebarIsOpened: !!select( interfaceStore ).getActiveComplementaryArea( 'isolated/editor' ),\n\t\t\tfixedToolbar: isFeatureActive( 'fixedToolbar', settings?.editor.hasFixedToolbar ),\n\t\t\tisInserterOpened: isInserterOpened(),\n\t\t\tisListViewOpened: isListViewOpened(),\n\t\t\tisFullscreenActive: isOptionActive( 'fullscreenMode' ),\n\t\t\tshowIconLabels: isFeatureActive( 'showIconLabels' ),\n\t\t\tpreviousShortcut: select( keyboardShortcutsStore ).getAllShortcutKeyCombinations(\n\t\t\t\t'core/edit-post/previous-region'\n\t\t\t),\n\t\t\tnextShortcut: select( keyboardShortcutsStore ).getAllShortcutKeyCombinations(\n\t\t\t\t'core/edit-post/next-region'\n\t\t\t),\n\t\t};\n\t}, [] );\n\tconst className = classnames( 'edit-post-layout', 'is-mode-' + editorMode, {\n\t\t'is-sidebar-opened': sidebarIsOpened,\n\t\t'is-inserter-opened': isInserterOpened,\n\t\t'has-fixed-toolbar': fixedToolbar,\n\t\t'show-icon-labels': showIconLabels,\n\t} );\n\tconst secondarySidebar = () => {\n\t\tif ( !inserterInSidebar ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( editorMode === 'visual' && isInserterOpened ) {\n\t\t\treturn <InserterSidebar />;\n\t\t}\n\n\t\tif ( editorMode === 'visual' && isListViewOpened ) {\n\t\t\treturn <ListViewSidebar />;\n\t\t}\n\n\t\treturn null;\n\t};\n\n\t// For back-compat with older iso-editor\n\tuseEffect( () => {\n\t\tconst html = document.querySelector( 'html' );\n\n\t\tif ( isFullscreenActive ) {\n\t\t\t// @ts-ignore\n\t\t\thtml.classList.add( 'is-fullscreen-mode' );\n\t\t} else {\n\t\t\t// @ts-ignore\n\t\t\thtml.classList.remove( 'is-fullscreen-mode' );\n\t\t}\n\n\t\treturn () => {\n\t\t\tif ( html ) {\n\t\t\t\thtml.classList.remove( 'is-fullscreen-mode' );\n\t\t\t}\n\t\t};\n\t}, [ isFullscreenActive ] );\n\n\tconst header = showHeader ? (\n\t\t<BlockEditorToolbar editorMode={ editorMode } settings={ settings } renderMoreMenu={ renderMoreMenu } />\n\t) : null;\n\tconst CustomSettingsSidebar = settings?.iso?.sidebar?.customComponent ?? SettingsSidebar;\n\n\treturn (\n\t\t<>\n\t\t\t<CustomSettingsSidebar documentInspector={ settings?.iso?.toolbar?.documentInspector ?? false } />\n\t\t\t<FullscreenMode isActive={ isFullscreenActive } />\n\n\t\t\t<InterfaceSkeleton\n\t\t\t\tclassName={ className }\n\t\t\t\tlabels={ interfaceLabels }\n\t\t\t\theader={ header }\n\t\t\t\tsecondarySidebar={ secondarySidebar() }\n\t\t\t\tsidebar={\n\t\t\t\t\t( !isMobileViewport || sidebarIsOpened ) &&\n\t\t\t\t\tinspectorInSidebar && <ComplementaryArea.Slot scope=\"isolated/editor\" />\n\t\t\t\t}\n\t\t\t\tnotices={ <EditorSnackbars /> }\n\t\t\t\tcontent={\n\t\t\t\t\t<>\n\t\t\t\t\t\t<EditorNotices />\n\n\t\t\t\t\t\t{ isEditing && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<BlockEditorKeyboardShortcuts />\n\t\t\t\t\t\t\t\t<BlockEditorKeyboardShortcuts.Register />\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) }\n\n\t\t\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\t\t\tbindGlobal={ false }\n\t\t\t\t\t\t\tshortcuts={ {\n\t\t\t\t\t\t\t\t[ rawShortcut.primary( 'z' ) ]: undo,\n\t\t\t\t\t\t\t\t[ rawShortcut.primaryShift( 'z' ) ]: redo,\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ editorMode === 'visual' && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t{ ! isLargeViewport && <BlockToolbar hideDragHandle /> }\n\t\t\t\t\t\t\t\t\t<VisualEditor styles={ styles } />\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t{ editorMode === 'text' && <TextEditor /> }\n\t\t\t\t\t\t</KeyboardShortcuts>\n\n\t\t\t\t\t\t{ children }\n\t\t\t\t\t</>\n\t\t\t\t}\n\t\t\t\tfooter={ showFooter && <Footer editorMode={ editorMode } /> }\n\t\t\t\tactions={ <ActionArea.Slot /> }\n\t\t\t\tshortcuts={ {\n\t\t\t\t\tprevious: previousShortcut,\n\t\t\t\t\tnext: nextShortcut,\n\t\t\t\t} }\n\t\t\t/>\n\t\t</>\n\t);\n}\n\nexport default withDispatch( ( dispatch ) => {\n\tconst { redo, undo } = dispatch( 'isolated/editor' );\n\treturn { redo, undo };\n} )( BlockEditor );\n"],"mappings":"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"}