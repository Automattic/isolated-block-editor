{"version":3,"sources":["../../../src/components/block-editor/index.js"],"names":["classnames","withDispatch","KeyboardShortcuts","rawShortcut","useViewportMatch","BlockEditorKeyboardShortcuts","EditorNotices","EditorSnackbars","FullscreenMode","ComplementaryArea","InterfaceSkeleton","store","interfaceStore","__","_x","useSelect","keyboardShortcutsStore","useEffect","SettingsSidebar","VisualEditor","TextEditor","BlockEditorToolbar","InserterSidebar","ListViewSidebar","Footer","interfaceLabels","secondarySidebar","header","body","sidebar","actions","footer","BlockEditor","props","isEditing","editorMode","children","undo","redo","settings","renderMoreMenu","styles","isMobileViewport","inspectorInSidebar","iso","inspector","inserterInSidebar","inserter","showFooter","sidebarIsOpened","hasFixedToolbar","isInserterOpened","isListViewOpened","showIconLabels","isFullscreenActive","previousShortcut","nextShortcut","select","isFeatureActive","isOptionActive","getActiveComplementaryArea","getAllShortcutKeyCombinations","className","document","querySelector","classList","add","remove","toolbar","documentInspector","primary","primaryShift","previous","next","dispatch"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { withDispatch } from '@wordpress/data';\nimport { KeyboardShortcuts } from '@wordpress/components';\nimport { rawShortcut } from '@wordpress/keycodes';\nimport { useViewportMatch } from '@wordpress/compose';\nimport { BlockEditorKeyboardShortcuts } from '@wordpress/block-editor';\nimport { EditorNotices, EditorSnackbars } from '@wordpress/editor';\nimport { FullscreenMode, ComplementaryArea, InterfaceSkeleton, store as interfaceStore } from '@wordpress/interface';\nimport { __, _x } from '@wordpress/i18n';\nimport { useSelect } from '@wordpress/data';\nimport { store as keyboardShortcutsStore } from '@wordpress/keyboard-shortcuts';\nimport { useEffect } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport SettingsSidebar from './sidebar';\nimport VisualEditor from './visual-editor';\nimport TextEditor from './text-editor';\nimport './style.scss';\nimport BlockEditorToolbar from '../block-editor-toolbar';\nimport InserterSidebar from './inserter-sidebar';\nimport ListViewSidebar from './listview-sidebar';\nimport Footer from './footer';\n\n/** @typedef {import('../../store/editor/reducer').EditorMode} EditorMode */\n/** @typedef {import('../../index').BlockEditorSettings} BlockEditorSettings */\n/** @typedef {import('../../index').OnMore} OnMore */\n\n/**\n * Undo/redo\n * @callback OnHistory\n */\n\nconst interfaceLabels = {\n\tsecondarySidebar: __( 'Block library' ),\n\t/* translators: accessibility text for the editor top bar landmark region. */\n\theader: __( 'Editor top bar' ),\n\t/* translators: accessibility text for the editor content landmark region. */\n\tbody: __( 'Editor content' ),\n\t/* translators: accessibility text for the editor settings landmark region. */\n\tsidebar: __( 'Editor settings' ),\n\t/* translators: accessibility text for the editor publish landmark region. */\n\tactions: __( 'Editor publish' ),\n\t/* translators: accessibility text for the editor footer landmark region. */\n\tfooter: __( 'Editor footer' ),\n};\n\n/**\n * The editor component. Contains the visual or text editor, along with keyboard handling.\n *\n * Note: the keyboard handling is specific to this editor and *not* global\n *\n * @param {object} props - Component props\n * @param {boolean} props.isEditing - Are we editing in this editor?\n * @param {EditorMode} props.editorMode - Visual or code?\n * @param {BlockEditorSettings} props.settings - Settings\n * @param {object} props.children - Child components\n * @param {OnHistory} props.undo\n * @param {OnHistory} props.redo\n * @param {OnMore} props.renderMoreMenu - Callback to render additional items in the more menu\n */\nfunction BlockEditor( props ) {\n\tconst { isEditing, editorMode, children, undo, redo, settings, renderMoreMenu } = props;\n\tconst styles = {}; // TODO: do we need hasThemeStyles support here?\n\tconst isMobileViewport = useViewportMatch( 'medium', '<' );\n\tconst inspectorInSidebar = settings?.iso?.sidebar?.inspector || false;\n\tconst inserterInSidebar = settings?.iso?.sidebar?.inserter || false;\n\tconst showFooter = settings?.iso?.footer || false;\n\tconst {\n\t\tsidebarIsOpened,\n\t\thasFixedToolbar,\n\t\tisInserterOpened,\n\t\tisListViewOpened,\n\t\tshowIconLabels,\n\t\tisFullscreenActive,\n\t\tpreviousShortcut,\n\t\tnextShortcut,\n\t} = useSelect( ( select ) => {\n\t\tconst { isFeatureActive, isInserterOpened, isListViewOpened, isOptionActive } = select( 'isolated/editor' );\n\n\t\treturn {\n\t\t\tsidebarIsOpened: !! select( interfaceStore ).getActiveComplementaryArea( 'isolated/editor' ),\n\t\t\thasFixedToolbar: isFeatureActive( 'fixedToolbar' ),\n\t\t\tisInserterOpened: isInserterOpened(),\n\t\t\tisListViewOpened: isListViewOpened(),\n\t\t\tisFullscreenActive: isOptionActive( 'fullscreenMode' ),\n\t\t\tshowIconLabels: isFeatureActive( 'showIconLabels' ),\n\t\t\tpreviousShortcut: select( keyboardShortcutsStore ).getAllShortcutKeyCombinations(\n\t\t\t\t'core/edit-post/previous-region'\n\t\t\t),\n\t\t\tnextShortcut: select( keyboardShortcutsStore ).getAllShortcutKeyCombinations(\n\t\t\t\t'core/edit-post/next-region'\n\t\t\t),\n\t\t};\n\t}, [] );\n\tconst className = classnames( 'edit-post-layout', 'is-mode-' + editorMode, {\n\t\t'is-sidebar-opened': sidebarIsOpened,\n\t\t'has-fixed-toolbar': hasFixedToolbar,\n\t\t'show-icon-labels': showIconLabels,\n\t} );\n\tconst secondarySidebar = () => {\n\t\tif ( ! inserterInSidebar ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( editorMode === 'visual' && isInserterOpened ) {\n\t\t\treturn <InserterSidebar />;\n\t\t}\n\n\t\tif ( editorMode === 'visual' && isListViewOpened ) {\n\t\t\treturn <ListViewSidebar />;\n\t\t}\n\n\t\treturn null;\n\t};\n\n\t// For back-compat with older iso-editor\n\tuseEffect( () => {\n\t\tif ( isFullscreenActive ) {\n\t\t\t// @ts-ignore\n\t\t\tdocument.querySelector( 'html' ).classList.add( 'is-fullscreen-mode' );\n\t\t} else {\n\t\t\t// @ts-ignore\n\t\t\tdocument.querySelector( 'html' ).classList.remove( 'is-fullscreen-mode' );\n\t\t}\n\t}, [ isFullscreenActive ] );\n\n\treturn (\n\t\t<>\n\t\t\t<SettingsSidebar documentInspector={ settings?.iso?.toolbar?.documentInspector ?? false } />\n\t\t\t<FullscreenMode isActive={ isFullscreenActive } />\n\n\t\t\t<InterfaceSkeleton\n\t\t\t\tclassName={ className }\n\t\t\t\tlabels={ interfaceLabels }\n\t\t\t\theader={\n\t\t\t\t\t<BlockEditorToolbar\n\t\t\t\t\t\teditorMode={ editorMode }\n\t\t\t\t\t\tsettings={ settings }\n\t\t\t\t\t\trenderMoreMenu={ renderMoreMenu }\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t\tsecondarySidebar={ secondarySidebar() }\n\t\t\t\tsidebar={\n\t\t\t\t\t( ! isMobileViewport || sidebarIsOpened ) &&\n\t\t\t\t\tinspectorInSidebar && <ComplementaryArea.Slot scope=\"isolated/editor\" />\n\t\t\t\t}\n\t\t\t\tnotices={ <EditorSnackbars /> }\n\t\t\t\tcontent={\n\t\t\t\t\t<>\n\t\t\t\t\t\t<EditorNotices />\n\n\t\t\t\t\t\t{ isEditing && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<BlockEditorKeyboardShortcuts />\n\t\t\t\t\t\t\t\t<BlockEditorKeyboardShortcuts.Register />\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) }\n\n\t\t\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\t\t\tbindGlobal={ false }\n\t\t\t\t\t\t\tshortcuts={ {\n\t\t\t\t\t\t\t\t[ rawShortcut.primary( 'z' ) ]: undo,\n\t\t\t\t\t\t\t\t[ rawShortcut.primaryShift( 'z' ) ]: redo,\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ editorMode === 'visual' && <VisualEditor styles={ styles } /> }\n\t\t\t\t\t\t\t{ editorMode === 'text' && <TextEditor /> }\n\t\t\t\t\t\t</KeyboardShortcuts>\n\n\t\t\t\t\t\t{ children }\n\t\t\t\t\t</>\n\t\t\t\t}\n\t\t\t\tfooter={ showFooter && <Footer editorMode={ editorMode } /> }\n\t\t\t\tactions={ null }\n\t\t\t\tshortcuts={ {\n\t\t\t\t\tprevious: previousShortcut,\n\t\t\t\t\tnext: nextShortcut,\n\t\t\t\t} }\n\t\t\t/>\n\t\t</>\n\t);\n}\n\nexport default withDispatch( ( dispatch ) => {\n\tconst { redo, undo } = dispatch( 'isolated/editor' );\n\treturn { redo, undo };\n} )( BlockEditor );\n"],"file":"index.js"}