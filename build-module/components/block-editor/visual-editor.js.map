{"version":3,"file":"visual-editor.js","names":["React","BlockList","WritingFlow","store","blockEditorStore","useSetting","__unstableEditorStyles","EditorStyles","__experimentalLayoutStyle","LayoutStyle","__unstableUseBlockSelectionClearer","useBlockSelectionClearer","__unstableUseTypewriter","useTypewriter","__unstableUseClipboardHandler","useClipboardHandler","__unstableUseTypingObserver","useTypingObserver","__experimentalUseResizeCanvas","useResizeCanvas","__unstableUseMouseMoveTypingReset","useMouseMoveTypingReset","__unstableIframe","Iframe","BlockTools","useSelect","__unstableMotion","motion","useRef","useMemo","useMergeRefs","EditorHeading","FooterSlot","MaybeIframe","children","contentRef","shouldIframe","styles","style","ref","assets","select","settings","getSettings","__unstableResolvedAssets","flex","width","height","display","PreviewWrapper","disableAnimations","initialStyle","currentStyle","props","VisualEditor","themeSupportsLayout","supportsLayout","canvasStyles","deviceType","disableCanvasAnimations","isIframePreview","getCanvasStyles","getPreviewDeviceType","getEditorSettings","resizedCanvasStyles","defaultLayout","previewMode","toLowerCase","desktopCanvasStyles","margin","flexFlow","background","animatedStyles","blockSelectionClearerRef","layout","undefined","usedLayout","definitions","type","padding"],"sources":["../../../src/components/block-editor/visual-editor.js"],"sourcesContent":["// @ts-nocheck\n/**\n * External dependencies\n */\nimport React from 'react';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tBlockList,\n\tWritingFlow,\n\tstore as blockEditorStore,\n\tuseSetting,\n\t__unstableEditorStyles as EditorStyles,\n\t__experimentalLayoutStyle as LayoutStyle,\n\t__unstableUseBlockSelectionClearer as useBlockSelectionClearer,\n\t__unstableUseTypewriter as useTypewriter,\n\t__unstableUseClipboardHandler as useClipboardHandler,\n\t__unstableUseTypingObserver as useTypingObserver,\n\t__experimentalUseResizeCanvas as useResizeCanvas,\n\t__unstableUseMouseMoveTypingReset as useMouseMoveTypingReset,\n\t__unstableIframe as Iframe,\n\tBlockTools,\n} from '@wordpress/block-editor';\nimport { useSelect } from '@wordpress/data';\nimport { __unstableMotion as motion } from '@wordpress/components';\nimport { useRef, useMemo } from '@wordpress/element';\nimport { useMergeRefs } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport EditorHeading from '../editor-heading-slot';\nimport FooterSlot from '../footer-slot';\n\nfunction MaybeIframe( { children, contentRef, shouldIframe, styles, style } ) {\n\tconst ref = useMouseMoveTypingReset();\n\n\tconst { assets } = useSelect( ( select ) => {\n\t\tconst settings = select( 'core/block-editor' ).getSettings();\n\t\treturn {\n\t\t\tassets: settings.__unstableResolvedAssets,\n\t\t};\n\t}, [] );\n\n\tif ( !shouldIframe ) {\n\t\t// TODO: this will add an EditorStyles for each editor on the page, which includes adding a <style> element. probably harmless but something to keep an eye on\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<EditorStyles styles={ styles } />\n\t\t\t\t<WritingFlow\n\t\t\t\t\tref={ contentRef }\n\t\t\t\t\tclassName=\"editor-styles-wrapper\"\n\t\t\t\t\tstyle={ { flex: '1', ...style } }\n\t\t\t\t\ttabIndex={ -1 }\n\t\t\t\t>\n\t\t\t\t\t{ children }\n\t\t\t\t</WritingFlow>\n\t\t\t</>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Iframe\n\t\t\thead={ <EditorStyles styles={ styles } /> }\n\t\t\tassets={ assets }\n\t\t\tref={ ref }\n\t\t\tcontentRef={ contentRef }\n\t\t\tstyle={ { width: '100%', height: '100%', display: 'block' } }\n\t\t\tname=\"editor-canvas\"\n\t\t>\n\t\t\t{ children }\n\t\t</Iframe>\n\t);\n}\n\nconst PreviewWrapper = ( { children, disableAnimations, initialStyle, currentStyle, ...props } ) => {\n\tif ( disableAnimations ) {\n\t\treturn <div style={ currentStyle } { ...props }>{ children }</div>;\n\t}\n\n\treturn (\n\t\t<motion.div animate={ currentStyle } initial={ initialStyle } { ...props }>\n\t\t\t{ children }\n\t\t</motion.div>\n\t);\n};\n\n/**\n * This is a copy of packages/edit-post/src/components/visual-editor/index.js\n *\n * The original is not exported, and contains code for post titles\n *\n * @param {Object} args\n * @param args.styles\n */\nconst VisualEditor = ( { styles } ) => {\n\tconst themeSupportsLayout = useSelect( ( select ) => {\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\treturn getSettings().supportsLayout;\n\t}, [] );\n\tconst { canvasStyles, deviceType, disableCanvasAnimations, isIframePreview } = useSelect( ( select ) => {\n\t\tconst { getCanvasStyles, getPreviewDeviceType, getEditorSettings, isIframePreview } =\n\t\t\tselect( 'isolated/editor' );\n\n\t\treturn {\n\t\t\tcanvasStyles: getCanvasStyles(),\n\t\t\tdeviceType: getPreviewDeviceType(),\n\t\t\tdisableCanvasAnimations: getEditorSettings().disableCanvasAnimations,\n\t\t\tisIframePreview: isIframePreview(),\n\t\t};\n\t}, [] );\n\tconst resizedCanvasStyles = useResizeCanvas( deviceType, false );\n\tconst defaultLayout = useSetting( 'layout' );\n\tconst previewMode = 'is-' + deviceType.toLowerCase() + '-preview';\n\n\tconst desktopCanvasStyles = {\n\t\t// We intentionally omit a 100% height here. The container is a flex item, so the 100% height is granted by default.\n\t\t// If a percentage height is present, older browsers such as Safari 13 apply that, but do so incorrectly as the inheritance is buggy.\n\t\twidth: '100%',\n\t\tmargin: 0,\n\t\tdisplay: 'flex',\n\t\tflexFlow: 'column',\n\t\t// Default background color so that grey\n\t\t// .edit-post-editor-regions__content color doesn't show through.\n\t\tbackground: 'white',\n\t};\n\tlet animatedStyles = desktopCanvasStyles;\n\n\tif ( resizedCanvasStyles ) {\n\t\tanimatedStyles = resizedCanvasStyles;\n\t}\n\n\tif ( canvasStyles ) {\n\t\tanimatedStyles = {\n\t\t\t...animatedStyles,\n\t\t\t...canvasStyles,\n\t\t};\n\t}\n\n\tconst blockSelectionClearerRef = useBlockSelectionClearer();\n\tconst ref = useRef();\n\tconst contentRef = useMergeRefs( [\n\t\tref,\n\t\tuseClipboardHandler(),\n\t\tuseTypewriter(),\n\t\tuseBlockSelectionClearer(),\n\t\tuseTypingObserver(),\n\t] );\n\n\tconst layout = useMemo( () => {\n\t\tif ( themeSupportsLayout ) {\n\t\t\treturn defaultLayout;\n\t\t}\n\n\t\treturn undefined;\n\t}, [ themeSupportsLayout, defaultLayout ] );\n\n\t// If there is a layout definition, then we're on Gutenberg > v14, which requires us to pass the\n\t// 'constrained' type\n\tconst usedLayout = layout?.definitions ? { ...layout, type: 'constrained' } : layout;\n\n\treturn (\n\t\t<BlockTools __unstableContentRef={ ref } className=\"edit-post-visual-editor\">\n\t\t\t<motion.div\n\t\t\t\tclassName=\"edit-post-visual-editor__content-area\"\n\t\t\t\tanimate={ {\n\t\t\t\t\tpadding: '0',\n\t\t\t\t} }\n\t\t\t\tref={ blockSelectionClearerRef }\n\t\t\t>\n\t\t\t\t<PreviewWrapper\n\t\t\t\t\tclassName={ previewMode }\n\t\t\t\t\tcurrentStyle={ animatedStyles }\n\t\t\t\t\tdisableAnimations={ disableCanvasAnimations }\n\t\t\t\t\tinitialStyle={ desktopCanvasStyles }\n\t\t\t\t>\n\t\t\t\t\t<MaybeIframe\n\t\t\t\t\t\tshouldIframe={ isIframePreview }\n\t\t\t\t\t\tcontentRef={ contentRef }\n\t\t\t\t\t\tstyles={ styles }\n\t\t\t\t\t\tstyle={ {} }\n\t\t\t\t\t>\n\t\t\t\t\t\t<LayoutStyle\n\t\t\t\t\t\t\tselector=\".edit-post-visual-editor__post-title-wrapper, .block-editor-block-list__layout.is-root-container\"\n\t\t\t\t\t\t\tlayout={ usedLayout }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<EditorHeading.Slot mode=\"visual\" />\n\t\t\t\t\t\t<BlockList className={ undefined } __experimentalLayout={ layout } />\n\t\t\t\t\t\t<FooterSlot.Slot mode=\"visual\" />\n\t\t\t\t\t</MaybeIframe>\n\t\t\t\t</PreviewWrapper>\n\t\t\t</motion.div>\n\t\t</BlockTools>\n\t);\n};\n\nexport default VisualEditor;\n"],"mappings":"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"}