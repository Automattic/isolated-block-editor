{"version":3,"file":"visual-editor.js","names":["React","BlockList","WritingFlow","store","blockEditorStore","useSetting","__unstableEditorStyles","EditorStyles","__experimentalLayoutStyle","LayoutStyle","__unstableUseBlockSelectionClearer","useBlockSelectionClearer","__unstableUseTypewriter","useTypewriter","__unstableUseClipboardHandler","useClipboardHandler","__unstableUseTypingObserver","useTypingObserver","__experimentalUseResizeCanvas","useResizeCanvas","__unstableUseMouseMoveTypingReset","useMouseMoveTypingReset","__unstableIframe","Iframe","BlockTools","useSelect","__unstableMotion","motion","useRef","useMemo","useMergeRefs","EditorHeading","FooterSlot","MaybeIframe","children","contentRef","shouldIframe","styles","style","ref","assets","select","settings","getSettings","__unstableResolvedAssets","flex","width","height","display","PreviewWrapper","disableAnimations","initialStyle","currentStyle","props","VisualEditor","themeSupportsLayout","supportsLayout","canvasStyles","deviceType","disableCanvasAnimations","isIframePreview","getCanvasStyles","getPreviewDeviceType","getEditorSettings","resizedCanvasStyles","defaultLayout","previewMode","toLowerCase","desktopCanvasStyles","margin","flexFlow","background","animatedStyles","blockSelectionClearerRef","layout","undefined","usedLayout","definitions","type","padding"],"sources":["../../../src/components/block-editor/visual-editor.js"],"sourcesContent":["// @ts-nocheck\n/**\n * External dependencies\n */\nimport React from 'react';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tBlockList,\n\tWritingFlow,\n\tstore as blockEditorStore,\n\tuseSetting,\n\t__unstableEditorStyles as EditorStyles,\n\t__experimentalLayoutStyle as LayoutStyle,\n\t__unstableUseBlockSelectionClearer as useBlockSelectionClearer,\n\t__unstableUseTypewriter as useTypewriter,\n\t__unstableUseClipboardHandler as useClipboardHandler,\n\t__unstableUseTypingObserver as useTypingObserver,\n\t__experimentalUseResizeCanvas as useResizeCanvas,\n\t__unstableUseMouseMoveTypingReset as useMouseMoveTypingReset,\n\t__unstableIframe as Iframe,\n\tBlockTools,\n} from '@wordpress/block-editor';\nimport { useSelect } from '@wordpress/data';\nimport { __unstableMotion as motion } from '@wordpress/components';\nimport { useRef, useMemo } from '@wordpress/element';\nimport { useMergeRefs } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport EditorHeading from '../editor-heading-slot';\nimport FooterSlot from '../footer-slot';\n\nfunction MaybeIframe( { children, contentRef, shouldIframe, styles, style } ) {\n\tconst ref = useMouseMoveTypingReset();\n\n\tconst { assets } = useSelect( ( select ) => {\n\t\tconst settings = select( 'core/block-editor' ).getSettings();\n\t\treturn {\n\t\t\tassets: settings.__unstableResolvedAssets,\n\t\t};\n\t}, [] );\n\n\tif ( !shouldIframe ) {\n\t\t// TODO: this will add an EditorStyles for each editor on the page, which includes adding a <style> element. probably harmless but something to keep an eye on\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<EditorStyles styles={ styles } />\n\t\t\t\t<WritingFlow\n\t\t\t\t\tref={ contentRef }\n\t\t\t\t\tclassName=\"editor-styles-wrapper\"\n\t\t\t\t\tstyle={ { flex: '1', ...style } }\n\t\t\t\t\ttabIndex={ -1 }\n\t\t\t\t>\n\t\t\t\t\t{ children }\n\t\t\t\t</WritingFlow>\n\t\t\t</>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Iframe\n\t\t\thead={ <EditorStyles styles={ styles } /> }\n\t\t\tassets={ assets }\n\t\t\tref={ ref }\n\t\t\tcontentRef={ contentRef }\n\t\t\tstyle={ { width: '100%', height: '100%', display: 'block' } }\n\t\t\tname=\"editor-canvas\"\n\t\t>\n\t\t\t{ children }\n\t\t</Iframe>\n\t);\n}\n\nconst PreviewWrapper = ( { children, disableAnimations, initialStyle, currentStyle, ...props } ) => {\n\tif ( disableAnimations ) {\n\t\treturn <div style={ currentStyle } { ...props }>{ children }</div>;\n\t}\n\n\treturn (\n\t\t<motion.div animate={ currentStyle } initial={ initialStyle } { ...props }>\n\t\t\t{ children }\n\t\t</motion.div>\n\t);\n};\n\n/**\n * This is a copy of packages/edit-post/src/components/visual-editor/index.js\n *\n * The original is not exported, and contains code for post titles\n *\n * @param {Object} args\n * @param args.styles\n */\nconst VisualEditor = ( { styles } ) => {\n\tconst themeSupportsLayout = useSelect( ( select ) => {\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\treturn getSettings().supportsLayout;\n\t}, [] );\n\tconst { canvasStyles, deviceType, disableCanvasAnimations, isIframePreview } = useSelect( ( select ) => {\n\t\tconst { getCanvasStyles, getPreviewDeviceType, getEditorSettings, isIframePreview } =\n\t\t\tselect( 'isolated/editor' );\n\n\t\treturn {\n\t\t\tcanvasStyles: getCanvasStyles(),\n\t\t\tdeviceType: getPreviewDeviceType(),\n\t\t\tdisableCanvasAnimations: getEditorSettings().disableCanvasAnimations,\n\t\t\tisIframePreview: isIframePreview(),\n\t\t};\n\t}, [] );\n\tconst resizedCanvasStyles = useResizeCanvas( deviceType, false );\n\tconst defaultLayout = useSetting( 'layout' );\n\tconst previewMode = 'is-' + deviceType.toLowerCase() + '-preview';\n\n\tconst desktopCanvasStyles = {\n\t\t// We intentionally omit a 100% height here. The container is a flex item, so the 100% height is granted by default.\n\t\t// If a percentage height is present, older browsers such as Safari 13 apply that, but do so incorrectly as the inheritance is buggy.\n\t\twidth: '100%',\n\t\tmargin: 0,\n\t\tdisplay: 'flex',\n\t\tflexFlow: 'column',\n\t\t// Default background color so that grey\n\t\t// .edit-post-editor-regions__content color doesn't show through.\n\t\tbackground: 'white',\n\t};\n\tlet animatedStyles = desktopCanvasStyles;\n\n\tif ( resizedCanvasStyles ) {\n\t\tanimatedStyles = resizedCanvasStyles;\n\t}\n\n\tif ( canvasStyles ) {\n\t\tanimatedStyles = {\n\t\t\t...animatedStyles,\n\t\t\t...canvasStyles,\n\t\t};\n\t}\n\n\tconst blockSelectionClearerRef = useBlockSelectionClearer();\n\tconst ref = useRef();\n\tconst contentRef = useMergeRefs( [\n\t\tref,\n\t\tuseClipboardHandler(),\n\t\tuseTypewriter(),\n\t\tuseBlockSelectionClearer(),\n\t\tuseTypingObserver(),\n\t] );\n\n\tconst layout = useMemo( () => {\n\t\tif ( themeSupportsLayout ) {\n\t\t\treturn defaultLayout;\n\t\t}\n\n\t\treturn undefined;\n\t}, [ themeSupportsLayout, defaultLayout ] );\n\n\t// If there is a layout definition, then we're on Gutenberg > v14, which requires us to pass the\n\t// 'constrained' type\n\tconst usedLayout = layout?.definitions ? { ...layout, type: 'constrained' } : layout;\n\n\treturn (\n\t\t<BlockTools __unstableContentRef={ ref } className=\"edit-post-visual-editor\">\n\t\t\t<motion.div\n\t\t\t\tclassName=\"edit-post-visual-editor__content-area\"\n\t\t\t\tanimate={ {\n\t\t\t\t\tpadding: '0',\n\t\t\t\t} }\n\t\t\t\tref={ blockSelectionClearerRef }\n\t\t\t>\n\t\t\t\t<PreviewWrapper\n\t\t\t\t\tclassName={ previewMode }\n\t\t\t\t\tcurrentStyle={ animatedStyles }\n\t\t\t\t\tdisableAnimations={ disableCanvasAnimations }\n\t\t\t\t\tinitialStyle={ desktopCanvasStyles }\n\t\t\t\t>\n\t\t\t\t\t<MaybeIframe\n\t\t\t\t\t\tshouldIframe={ isIframePreview }\n\t\t\t\t\t\tcontentRef={ contentRef }\n\t\t\t\t\t\tstyles={ styles }\n\t\t\t\t\t\tstyle={ {} }\n\t\t\t\t\t>\n\t\t\t\t\t\t<LayoutStyle\n\t\t\t\t\t\t\tselector=\".edit-post-visual-editor__post-title-wrapper, .block-editor-block-list__layout.is-root-container\"\n\t\t\t\t\t\t\tlayout={ usedLayout }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<EditorHeading.Slot mode=\"visual\" />\n\t\t\t\t\t\t<BlockList className={ undefined } __experimentalLayout={ layout } />\n\t\t\t\t\t\t<FooterSlot.Slot mode=\"visual\" />\n\t\t\t\t\t</MaybeIframe>\n\t\t\t\t</PreviewWrapper>\n\t\t\t</motion.div>\n\t\t</BlockTools>\n\t);\n};\n\nexport default VisualEditor;\n"],"mappings":"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"}