{"version":3,"file":"index.js","names":["render","unmountComponentAtNode","IsolatedBlockEditor","settings","iso","moreMenu","saveBlocks","content","textarea","value","onLoad","parser","rawHandler","indexOf","HTML","attachEditor","userSettings","type","toLowerCase","editor","document","createElement","classList","add","parentNode","insertBefore","nextSibling","style","display","location","reload","detachEditor","contains","removeChild","window","wp"],"sources":["../../src/browser/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\n\nimport { render, unmountComponentAtNode } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\n\nimport './style.scss';\nimport IsolatedBlockEditor from '../index';\n\n/** @typedef {import('../index').BlockEditorSettings} BlockEditorSettings */\n\n/**\n * These are the Gutenberg and IsolatedBlockEditor settings. Everything not set uses the defaults.\n *\n * @type BlockEditorSettings\n */\nconst settings = {\n\tiso: {\n\t\tmoreMenu: false,\n\t},\n};\n\n/**\n * Saves content to the textarea\n *\n * @param {string} content Serialized block content\n * @param {HTMLTextAreaElement} textarea Textarea node\n */\nfunction saveBlocks( content, textarea ) {\n\ttextarea.value = content;\n}\n\n/**\n * Initial content loader. Determine if the textarea contains blocks or raw HTML\n *\n * @param {string} content Text area content\n * @param {*} parser Gutenberg `parse` function\n * @param {*} rawHandler Gutenberg `rawHandler` function\n */\nfunction onLoad( content, parser, rawHandler ) {\n\t// Does the content contain blocks?\n\tif ( content.indexOf( '<!--' ) !== -1 ) {\n\t\t// Parse the blocks\n\t\treturn parser( content );\n\t}\n\n\t// Raw HTML - do our best\n\treturn rawHandler( { HTML: content } );\n}\n\n/**\n * Attach IsolatedBlockEditor to a textarea\n *\n * @param {HTMLTextAreaElement} textarea Textarea node\n * @param {BlockEditorSettings} userSettings Settings object\n */\nfunction attachEditor( textarea, userSettings = {} ) {\n\t// Check it's a textarea\n\tif ( textarea.type.toLowerCase() !== 'textarea' ) {\n\t\treturn;\n\t}\n\n\t// Create a node after the textarea\n\tconst editor = document.createElement( 'div' );\n\teditor.classList.add( 'editor' );\n\n\t// Insert after the textarea, and hide it\n\t// @ts-ignore\n\ttextarea.parentNode.insertBefore( editor, textarea.nextSibling );\n\ttextarea.style.display = 'none';\n\n\t// Render the editor\n\trender(\n\t\t<IsolatedBlockEditor\n\t\t\tsettings={ { ...settings, ...userSettings } }\n\t\t\tonLoad={ ( parser, rawHandler ) => onLoad( textarea.value, parser, rawHandler ) }\n\t\t\tonSaveContent={ ( content ) => saveBlocks( content, textarea ) }\n\t\t\tonError={ () => document.location.reload() }\n\t\t></IsolatedBlockEditor>,\n\t\teditor\n\t);\n}\n\n/**\n * Remove IsolatedBlockEditor from a textarea node\n *\n * @param {HTMLTextAreaElement} textarea Textarea node\n */\nfunction detachEditor( textarea ) {\n\t/**\n\t * @type {HTMLElement}\n\t */\n\t// @ts-ignore\n\tconst editor = textarea.nextSibling;\n\n\tif ( editor && editor.classList.contains( 'editor' ) ) {\n\t\tunmountComponentAtNode( editor );\n\n\t\t// @ts-ignore\n\t\ttextarea.style.display = null;\n\t\t// @ts-ignore\n\t\teditor.parentNode.removeChild( editor );\n\t}\n}\n\n// This adds the functions to the WP global, making it easier for the example to work.\nwindow.wp = {\n\tattachEditor,\n\tdetachEditor,\n};\n"],"mappings":";;AAAA;AACA;AACA;AAEA,SAASA,MAAT,EAAiBC,sBAAjB,QAA+C,oBAA/C;AAEA;AACA;AACA;;AAEA,OAAO,cAAP;AACA,OAAOC,mBAAP,MAAgC,UAAhC;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AACA,MAAMC,QAAQ,GAAG;EAChBC,GAAG,EAAE;IACJC,QAAQ,EAAE;EADN;AADW,CAAjB;AAMA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,UAAT,CAAqBC,OAArB,EAA8BC,QAA9B,EAAyC;EACxCA,QAAQ,CAACC,KAAT,GAAiBF,OAAjB;AACA;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASG,MAAT,CAAiBH,OAAjB,EAA0BI,MAA1B,EAAkCC,UAAlC,EAA+C;EAC9C;EACA,IAAKL,OAAO,CAACM,OAAR,CAAiB,MAAjB,MAA8B,CAAC,CAApC,EAAwC;IACvC;IACA,OAAOF,MAAM,CAAEJ,OAAF,CAAb;EACA,CAL6C,CAO9C;;;EACA,OAAOK,UAAU,CAAE;IAAEE,IAAI,EAAEP;EAAR,CAAF,CAAjB;AACA;AAED;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASQ,YAAT,CAAuBP,QAAvB,EAAqD;EAAA,IAApBQ,YAAoB,uEAAL,EAAK;;EACpD;EACA,IAAKR,QAAQ,CAACS,IAAT,CAAcC,WAAd,OAAgC,UAArC,EAAkD;IACjD;EACA,CAJmD,CAMpD;;;EACA,MAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAwB,KAAxB,CAAf;EACAF,MAAM,CAACG,SAAP,CAAiBC,GAAjB,CAAsB,QAAtB,EARoD,CAUpD;EACA;;EACAf,QAAQ,CAACgB,UAAT,CAAoBC,YAApB,CAAkCN,MAAlC,EAA0CX,QAAQ,CAACkB,WAAnD;EACAlB,QAAQ,CAACmB,KAAT,CAAeC,OAAf,GAAyB,MAAzB,CAboD,CAepD;;EACA5B,MAAM,CACL,cAAC,mBAAD;IACC,QAAQ,EAAG,EAAE,GAAGG,QAAL;MAAe,GAAGa;IAAlB,CADZ;IAEC,MAAM,EAAG,CAAEL,MAAF,EAAUC,UAAV,KAA0BF,MAAM,CAAEF,QAAQ,CAACC,KAAX,EAAkBE,MAAlB,EAA0BC,UAA1B,CAF1C;IAGC,aAAa,EAAKL,OAAF,IAAeD,UAAU,CAAEC,OAAF,EAAWC,QAAX,CAH1C;IAIC,OAAO,EAAG,MAAMY,QAAQ,CAACS,QAAT,CAAkBC,MAAlB;EAJjB,EADK,EAOLX,MAPK,CAAN;AASA;AAED;AACA;AACA;AACA;AACA;;;AACA,SAASY,YAAT,CAAuBvB,QAAvB,EAAkC;EACjC;AACD;AACA;EACC;EACA,MAAMW,MAAM,GAAGX,QAAQ,CAACkB,WAAxB;;EAEA,IAAKP,MAAM,IAAIA,MAAM,CAACG,SAAP,CAAiBU,QAAjB,CAA2B,QAA3B,CAAf,EAAuD;IACtD/B,sBAAsB,CAAEkB,MAAF,CAAtB,CADsD,CAGtD;;IACAX,QAAQ,CAACmB,KAAT,CAAeC,OAAf,GAAyB,IAAzB,CAJsD,CAKtD;;IACAT,MAAM,CAACK,UAAP,CAAkBS,WAAlB,CAA+Bd,MAA/B;EACA;AACD,C,CAED;;;AACAe,MAAM,CAACC,EAAP,GAAY;EACXpB,YADW;EAEXgB;AAFW,CAAZ"}