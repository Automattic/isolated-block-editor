{"version":3,"sources":["../src/index.js"],"names":["__","StrictMode","SlotFillProvider","MediaUpload","registerCoreBlocks","addFilter","use","ShortcutProvider","BlockEditorContainer","withRegistryProvider","EditorSetup","PatternMonitor","ContentSaver","registerApiHandlers","storeHotSwapPlugin","DocumentSection","ToolbarSlot","CollaborativeEditing","FooterSlot","EditorLoaded","initializeEditor","window","isoInitialised","initializeIsoEditor","isoInitialisedBlocks","IsolatedBlockEditor","props","children","onSaveContent","onSaveBlocks","settings","params"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\n\nimport '@wordpress/editor';\nimport { __ } from '@wordpress/i18n';\nimport { StrictMode } from '@wordpress/element';\nimport { SlotFillProvider } from '@wordpress/components';\nimport { MediaUpload } from '@wordpress/media-utils';\nimport { registerCoreBlocks } from '@wordpress/block-library';\nimport { addFilter } from '@wordpress/hooks';\nimport { use } from '@wordpress/data';\nimport '@wordpress/format-library';\nimport { ShortcutProvider } from '@wordpress/keyboard-shortcuts';\n\n/**\n * Internal dependencies\n */\n\nimport BlockEditorContainer from './components/block-editor-container';\nimport withRegistryProvider from './components/with-registry-provider';\nimport EditorSetup from './components/editor-setup';\nimport PatternMonitor from './components/pattern-monitor';\nimport ContentSaver from './components/content-saver';\nimport registerApiHandlers from './components/api-fetch';\nimport storeHotSwapPlugin from './store/plugins/store-hot-swap';\nimport DocumentSection from './components/document';\nimport ToolbarSlot from './components/block-editor-toolbar/slot';\nimport CollaborativeEditing from './components/collaborative-editing';\nimport FooterSlot from './components/footer-slot';\n\n// Export library components\nimport EditorLoaded from './components/editor-loaded';\n\n// A fake edit-post store is needed\nimport './store/edit-post';\nimport './style.scss';\n\n/** @typedef {import('./components/block-editor-toolbar/more-menu').OnMore} OnMore */\n/** @typedef {import('./store/editor/reducer').Pattern} Pattern */\n\n/**\n * Toolbar settings\n * @typedef ToolbarSettings\n * @property {boolean} [inserter] - Enable or disable the toolbar block inserter\n * @property {boolean} [inspector] - Enable or disable the toolbar block inspector\n * @property {boolean} [navigation] - Enable or disable the toolbar navigation button\n * @property {boolean} [toc] - Enable or disable the toolbar table of contents button\n * @property {boolean} [undo] - Enable or disable the toolbar undo/redo buttons\n * @property {boolean} [selectorTool] - Enable or disable the selector tool\n * @property {boolean} [documentInspector] - Enable or disable the document inspector\n */\n\n/**\n * More menu settings\n * @typedef MoreMenuSettings\n * @property {boolean} [editor] - Enable or disable the editor sub menu (visual/code editing)\n * @property {boolean} [fullscreen] - Enable or disable the fullscreen option\n * @property {boolean} [preview] - Enable or disable the preview option\n * @property {boolean} [topToolbar] - Enable or disable the 'top toolbar' option\n */\n\n/**\n * Sidebar settings\n * @typedef SidebarSettings\n * @property {boolean} [inspector=false] - Display the block inspector in a sidebar (true) or popover (false)\n * @property {boolean} [inserter=false] - Display the block inserter in a sidebar (true) or popover (false)\n */\n\n/**\n * Isolated Editor Settings\n * @typedef IsoSettings\n * @property {string|null} [preferencesKey] - Preferences key. Set to null to disable\n * @property {string|null} [persistenceKey] - Persistence key. Set to null to disable\n * @property {{allowBlocks: string[], disallowBlocks: string[]}} [blocks] - Block restrictions\n * @property {string[]} [disallowEmbed] - List of embed names to remove\n * @property {object[]} [customStores] - Array of custom stores\n * @property {boolean} [footer] - Show footer component\n * @property {ToolbarSettings} [toolbar] - Toolbar settings\n * @property {MoreMenuSettings|false} [moreMenu] - More menu settings, or false to disable\n * @property {{title: string, url: string}[]} [linkMenu] - Link menu settings\n * @property {string|null} [currentPattern] - The pattern to start with\n * @property {Pattern[]} [patterns] - List of patterns\n * @property {object} [defaultPreferences] - Default preferences if nothing in localStorage\n * @property {boolean} [allowApi] - Allow API requests\n * @property {SidebarSettings} [sidebar] - Configure sidebar functionality\n */\n\n/**\n * Block Editor Settings\n * @typedef BlockEditorSettings\n * @property {IsoSettings} [iso] - Isolated editor settings\n * @property {EditorSettings} [editor] - Gutenberg editor settings\n */\n\n/**\n * Gutenberg Editor Settings - this isn't the complete object, but just enough for linting here\n * @typedef EditorSettings\n * @property {boolean} hasUploadPermissions\n * @property {object} allowedMimeTypes\n * @property {string[]} allowedBlockTypes\n * @property {boolean} hasFixedToolbar\n * @property {null|object} mediaUpload\n * @property {object[]|null} template\n * @property {null} templateLock\n * @property {object[]} reusableBlocks\n * @property {object[]} styles\n * @property {object[]} defaultEditorStyles\n */\n\n/**\n * Initialize Gutenberg\n */\nexport function initializeEditor() {\n\tif ( window.isoInitialised ) {\n\t\treturn;\n\t}\n\n\t// Register all core blocks\n\tregisterCoreBlocks();\n\n\twindow.isoInitialised = true;\n}\n\nexport function initializeIsoEditor() {\n\tif ( window.isoInitialisedBlocks ) {\n\t\treturn;\n\t}\n\n\tinitializeEditor();\n\n\t// This allows the editor to swap stores dynamically\n\tuse( storeHotSwapPlugin, {} );\n\n\t// This is needed for the media uploader\n\taddFilter( 'editor.MediaUpload', 'isolated-block-editor/media-upload', () => MediaUpload );\n\n\tregisterApiHandlers();\n\n\t// Don't run this again\n\twindow.isoInitialisedBlocks = true;\n}\n\n/**\n * Save blocks callback\n * @callback OnSaveBlocks\n * @param {object[]} blocks - Editor content to save\n * @param {string[]} ignoredContent - Possible content to ignore\n */\n\n/**\n * Save HTML content callback\n * @callback OnSaveContent\n * @param {string} content - Serialized content\n */\n\n/**\n * Parser callback\n * @callback OnParse\n * @param {string} content - HTML content\n * @returns {object[]}\n */\n\n/**\n * Initial load blocks callback\n * @callback OnLoad\n * @param {OnParse} parse - Current block parser\n * @param {OnParse} rawHandler - Current raw handler\n * @returns {object[]|Promise}\n */\n\n/**\n * Error callback\n * @callback OnError\n */\n\n/**\n * Isolated block editor component.\n *\n * This wraps up the Gutenberg editor along with a customised store. The contents of the editor are unique, and multiple instances\n * can be created.\n *\n * @param {object} props - Component props\n * @param {OnSaveBlocks} [props.onSaveBlocks] - Save callback\n * @param {OnSaveContent} [props.onSaveContent] - Save callback\n * @param {OnError} props.onError - Error callback\n * @param {OnLoad} [props.onLoad] - Initial blocks\n * @param {BlockEditorSettings} props.settings - Settings\n * @param {object} props.children - Child content\n * @param {string} [props.className] - Additional class name\n * @param {OnMore} [props.renderMoreMenu] - Callback to render additional items in the more menu\n */\nfunction IsolatedBlockEditor( props ) {\n\tconst { children, onSaveContent, onSaveBlocks, settings, ...params } = props;\n\n\tinitializeIsoEditor();\n\n\treturn (\n\t\t<StrictMode>\n\t\t\t<ShortcutProvider>\n\t\t\t\t<ContentSaver onSaveBlocks={ onSaveBlocks } onSaveContent={ onSaveContent } />\n\t\t\t\t<EditorSetup settings={ settings } />\n\t\t\t\t<PatternMonitor />\n\n\t\t\t\t<SlotFillProvider>\n\t\t\t\t\t<BlockEditorContainer { ...params } settings={ settings }>\n\t\t\t\t\t\t{ children }\n\t\t\t\t\t</BlockEditorContainer>\n\t\t\t\t</SlotFillProvider>\n\t\t\t</ShortcutProvider>\n\t\t</StrictMode>\n\t);\n}\n\nexport default withRegistryProvider( IsolatedBlockEditor );\n\nexport { EditorLoaded, DocumentSection, ToolbarSlot, CollaborativeEditing, FooterSlot };\n"],"file":"index.js"}